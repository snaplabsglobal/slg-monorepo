# è§’åº¦é”å®š UI/UX - å¿«é€Ÿæ‰§è¡Œæ¸…å•

> **CTO 5åˆ†é’Ÿé€ŸæŸ¥å¡**  
> **é¢„è®¡å·¥ä½œé‡ï¼š** 1.5å¤©  
> **ä¼˜å…ˆçº§ï¼š** ğŸ”´ P0 - Critical

---

## âš¡ ä¸€å¥è¯ç›®æ ‡

**ä¸æ˜¯ï¼š** è§’åº¦é”å®šç®—æ³•æ­£ç¡®  
**è€Œæ˜¯ï¼š** ç”¨æˆ·èƒ½"çœ‹åˆ°"å’Œ"æ„Ÿè§‰åˆ°"è§’åº¦è¢«é”ä½

**CPOåŸè¯ï¼š**
> "ç®—æ³•å·²ç»é€šè¿‡ï¼Œç°åœ¨è¿™ä¸æ˜¯'æŠ€æœ¯é—®é¢˜'ï¼Œæ˜¯'ä¿¡ä»»æ„Ÿé—®é¢˜'ã€‚"

---

## ğŸ¯ ä¸‰ä¸ªæ ¸å¿ƒç»„ä»¶ï¼ˆå¿…é¡»å…¨éƒ¨å®ç°ï¼‰

### 1. å…‰æ ‡é™„è¿‘è§’åº¦æç¤º â­â­â­

**æ˜¾ç¤ºè§„åˆ™ï¼š**
```
FREE â†’ ä¸æ˜¾ç¤º
SNAP â†’ "45Â°"ï¼ˆæµ…è“ï¼ŒSemi-boldï¼‰
ORTHO â†’ "ORTHO 90Â°"ï¼ˆæ·±è“ï¼ŒBoldï¼‰
LOCKED â†’ "LOCKED 30Â°"ï¼ˆæœ€æ·±è“ï¼ŒBoldï¼‰
```

**ä½ç½®ï¼š** é¼ æ ‡+14pxï¼Œè·Ÿéšç§»åŠ¨

---

### 2. çº¿æ¡é¢œè‰²å˜åŒ–

**æ ·å¼è§„åˆ™ï¼š**
```
FREE â†’ æ·±ç° (#333)
SNAP â†’ æµ…è“ (#4A9EFF)
ORTHO â†’ æ·±è“ (#2A7FFF)
LOCKED â†’ æ·±è“ (#1F5EFF) + åŠ ç²—15%
```

**åŸåˆ™ï¼š** è¢«æ§åˆ¶çš„çº¿çœ‹èµ·æ¥å°±ä¸ä¸€æ ·

---

### 3. Shiftå¢å¼ºæç¤º

**æŒ‰ä¸‹ç¬é—´ï¼š**
```
Toast: "ORTHO MODE"ï¼ˆ0.8ç§’ï¼‰
å…‰æ ‡æ–‡å­—: "ORTHO 90Â°" æˆ– "ORTHO 0Â°"
```

**ç¡¬æ€§è§„åˆ™ï¼š**
```
ShiftæœŸé—´ç¦æ­¢30/45/60
åªèƒ½0Â°æˆ–90Â°
```

---

## ğŸ”§ æ ¸å¿ƒä»£ç ï¼ˆCopy & Pasteï¼‰

### 1. çŠ¶æ€æšä¸¾

```typescript
export type AngleMode = 
  | 'FREE'        // è‡ªç”±
  | 'SNAP'        // æ™ºèƒ½å¸é™„
  | 'SHIFT_ORTHO' // Shiftæ­£äº¤
  | 'LOCKED'      // æ˜¾å¼é”å®š

export type AngleSource =
  | 'none' | 'smart' | 'shift' | 'lock' | 'typed' | 'infer'
```

---

### 2. HUDæ•°æ®æ¨¡å‹

```typescript
export interface AngleHUDModel {
  mode: AngleMode
  source: AngleSource
  snappedDeg: number | null
  
  // UIæ–‡æ¡ˆï¼ˆå”¯ä¸€æ¥æºï¼‰
  textNearCursor: string | null  // "45Â°" | "ORTHO 90Â°"
  statusBarText: string          // "Angle: Snap 45Â°"
  
  // æ ·å¼token
  styleToken: 'free' | 'snap' | 'ortho' | 'locked'
  
  // Toast
  toast?: { text: string; ttlMs: number } | null
}
```

---

### 3. HUDæ´¾ç”Ÿå‡½æ•°ï¼ˆæ–‡æ¡ˆæ˜ å°„ï¼‰

```typescript
export function deriveAngleHUD(
  angleInfo: EngineAngleInfo | undefined,
  opts?: { justPressedShift?: boolean }
): AngleHUDModel {
  const mode: AngleMode =
    angleInfo?.mode === 'shift' ? 'SHIFT_ORTHO' :
    angleInfo?.mode === 'lock'  ? 'LOCKED' :
    angleInfo?.mode === 'snap'  ? 'SNAP' :
    'FREE'

  const snappedDeg =
    mode === 'FREE' ? null :
    angleInfo?.angleDeg != null ? Math.round(angleInfo.angleDeg) : null

  const textNearCursor =
    mode === 'FREE' ? null :
    mode === 'SHIFT_ORTHO' ? `ORTHO ${snappedDeg}Â°` :
    mode === 'LOCKED' ? `LOCKED ${snappedDeg}Â°` :
    `${snappedDeg}Â°`

  const statusBarText =
    mode === 'FREE' ? 'Angle: Free' :
    mode === 'SHIFT_ORTHO' ? 'Angle: Ortho' :
    mode === 'LOCKED' ? `Angle: Locked ${snappedDeg}Â°` :
    `Angle: Snap ${snappedDeg}Â°`

  const styleToken =
    mode === 'FREE' ? 'free' :
    mode === 'SNAP' ? 'snap' :
    mode === 'SHIFT_ORTHO' ? 'ortho' : 'locked'

  const toast = opts?.justPressedShift 
    ? { text: 'ORTHO MODE', ttlMs: 800 } 
    : null

  return {
    mode,
    source: mode === 'SHIFT_ORTHO' ? 'shift' : 
            mode === 'LOCKED' ? 'lock' : 
            mode === 'SNAP' ? 'smart' : 'none',
    snappedDeg,
    textNearCursor,
    statusBarText,
    styleToken,
    toast,
  }
}
```

---

### 4. AngleHUDç»„ä»¶

```typescript
export function AngleHUD(props: {
  hud: AngleHUDModel
  cursorScreen: { x: number; y: number }
}) {
  const { hud, cursorScreen } = props
  if (!hud.textNearCursor) return null

  const left = cursorScreen.x + 14
  const top = cursorScreen.y + 14

  const className = `angle-hud angle-hud-${hud.styleToken}`

  return (
    <>
      <div className={className} style={{ 
        position: 'fixed', left, top,
        pointerEvents: 'none', zIndex: 9999 
      }}>
        {hud.textNearCursor}
      </div>

      {hud.toast && (
        <div className="angle-hud-toast" style={{
          position: 'fixed',
          left: cursorScreen.x - 30,
          top: cursorScreen.y - 40,
          pointerEvents: 'none', zIndex: 9999
        }}>
          {hud.toast.text}
        </div>
      )}
    </>
  )
}
```

---

### 5. çº¿æ¡æ ·å¼å‡½æ•°

```typescript
export function getPreviewStrokeStyle(
  hud: AngleHUDModel, 
  baseWidth: number = 1
) {
  switch (hud.styleToken) {
    case 'locked':
      return { color: '#1F5EFF', width: baseWidth * 1.15 }
    case 'ortho':
      return { color: '#2A7FFF', width: baseWidth }
    case 'snap':
      return { color: '#4A9EFF', width: baseWidth }
    default:
      return { color: '#333333', width: baseWidth }
  }
}
```

---

### 6. Reduceré›†æˆ

```typescript
function onPointerMove(world, screen, opts) {
  const inf = engine.inferDraw(/* ... */)
  
  setPreviewEnd(inf.point)
  
  // âœ… å…³é”®ï¼šæ£€æµ‹Shiftå˜åŒ–
  const justPressedShift = !prevShift && opts.shift
  setPrevShift(opts.shift)
  
  // âœ… å…³é”®ï¼šæ´¾ç”ŸHUD
  const hud = deriveAngleHUD(inf.angleInfo, { justPressedShift })
  
  setAngleHUD(hud)
  setCursorScreen(screen)
}
```

---

## ğŸ“‹ 1.5å¤©è®¡åˆ’

### Day 1 ä¸Šåˆï¼šæ ¸å¿ƒHUDï¼ˆ0.5å¤©ï¼‰

- [ ] å®ç°ç±»å‹å®šä¹‰ï¼ˆ`AngleMode`, `AngleHUDModel`ï¼‰
- [ ] å®ç° `deriveAngleHUD()` å‡½æ•°
- [ ] å®ç° `AngleHUD` ç»„ä»¶
- [ ] åœ¨reducerä¸­é›†æˆ

**éªŒæ”¶ï¼š** å…‰æ ‡é™„è¿‘èƒ½æ˜¾ç¤ºè§’åº¦æ–‡å­—

---

### Day 1 ä¸‹åˆï¼šè§†è§‰åé¦ˆï¼ˆ0.5å¤©ï¼‰

- [ ] å®ç° `getPreviewStrokeStyle()`
- [ ] åœ¨Canvasæ¸²æŸ“ä¸­åº”ç”¨é¢œè‰²
- [ ] LOCKEDæ¨¡å¼åŠ ç²—15%
- [ ] æ·»åŠ CSSæ ·å¼

**éªŒæ”¶ï¼š** çº¿æ¡é¢œè‰²éšçŠ¶æ€å˜åŒ–

---

### Day 2 ä¸Šåˆï¼šShiftå¢å¼ºï¼ˆ0.5å¤©ï¼‰

- [ ] ShiftæŒ‰ä¸‹æ˜¾ç¤ºToast
- [ ] å®ç° `StatusBar` ç»„ä»¶
- [ ] æ£€æµ‹ShiftçŠ¶æ€å˜åŒ–
- [ ] æ·»åŠ fadeOutåŠ¨ç”»

**éªŒæ”¶ï¼š** Shiftæç¤ºæ¸…æ™°

---

## âœ… éªŒæ”¶æ¸…å•ï¼ˆ3ä¸ªå…³é”®åœºæ™¯ï¼‰

### åœºæ™¯1ï¼šSmart Snap

```
æ“ä½œï¼šç”»çº¿æ¥è¿‘45Â°
æœŸæœ›ï¼š
  - å…‰æ ‡é™„è¿‘æ˜¾ç¤º "45Â°"
  - çº¿æ¡å˜æˆæµ…è“è‰² (#4A9EFF)
  - çŠ¶æ€æ æ˜¾ç¤º "Angle: Snap 45Â°"
```

---

### åœºæ™¯2ï¼šShiftæ­£äº¤

```
æ“ä½œï¼šæŒ‰ä½Shiftç”»çº¿
æœŸæœ›ï¼š
  - Toastæ˜¾ç¤º "ORTHO MODE"ï¼ˆ0.8ç§’ï¼‰
  - å…‰æ ‡æ˜¾ç¤º "ORTHO 90Â°" æˆ– "ORTHO 0Â°"
  - çº¿æ¡å˜æˆæ·±è“è‰² (#2A7FFF)
  - çŠ¶æ€æ æ˜¾ç¤º "Angle: Ortho"
```

---

### åœºæ™¯3ï¼šæ˜¾å¼é”å®š

```
æ“ä½œï¼šé”å®š30Â°åç”»çº¿
æœŸæœ›ï¼š
  - å…‰æ ‡æ˜¾ç¤º "LOCKED 30Â°"
  - çº¿æ¡æ·±è“è‰² (#1F5EFF) + åŠ ç²—15%
  - çŠ¶æ€æ æ˜¾ç¤º "Angle: Locked 30Â°"
```

---

## ğŸš¨ å¸¸è§é™·é˜±

### é™·é˜±1ï¼šUIè‡ªå·±çŒœçŠ¶æ€

```typescript
// âŒ é”™è¯¯
if (isSnapped) {
  return <div>{angleDeg}Â°</div>
}

// âœ… æ­£ç¡®
return <div>{hud.textNearCursor}</div>
```

---

### é™·é˜±2ï¼šæ–‡æ¡ˆä¸ä¸€è‡´

```
âŒ æœ‰çš„æ˜¾ç¤º "90Â°"ï¼Œæœ‰çš„æ˜¾ç¤º "Ortho 90Â°"
âœ… æ‰€æœ‰ORTHOéƒ½æ˜¾ç¤º "ORTHO 90Â°"
```

---

### é™·é˜±3ï¼šPreviewå’ŒCommitä¸ä¸€è‡´

```
âŒ Previewè“è‰²ï¼ŒCommité»‘è‰²
âœ… éƒ½ä½¿ç”¨ getPreviewStrokeStyle()
```

---

### é™·é˜±4ï¼šå¿˜è®°Hysteresis

```
âŒ é¼ æ ‡æ™ƒåŠ¨è§’åº¦ç–¯ç‹‚è·³
âœ… è¿›å…¥Â±3Â°ï¼Œè„±ç¦»Â±6Â°
```

---

## ğŸ’¬ CEOéªŒæ”¶æ ‡å‡†

**CEOï¼ˆéCTOï¼‰æµ‹è¯•ï¼š**
1. æ‰“å¼€PlanSnap
2. ç”»3æ¡çº¿
3. ä¸çœ‹æ–‡æ¡£

**é—®é¢˜ï¼š** èƒ½æ˜ç¡®æ„ŸçŸ¥ä»€ä¹ˆæ—¶å€™çº¿æ˜¯"è¢«æ§åˆ¶çš„"å—ï¼Ÿ

```
âœ… Yes â†’ é€šè¿‡
âŒ "å¥½åƒæœ‰ï¼Œä½†ä¸ç¡®å®š" â†’ è¿”å·¥
```

---

## ğŸ“Š å®Œæ•´æ–‡æ¡ˆè¡¨

| çŠ¶æ€ | å…‰æ ‡æ–‡å­— | çŠ¶æ€æ  | çº¿æ¡é¢œè‰² |
|------|---------|--------|---------|
| FREE | - | `Angle: Free` | `#333` |
| SNAP | `45Â°` | `Angle: Snap 45Â°` | `#4A9EFF` |
| ORTHO | `ORTHO 90Â°` | `Angle: Ortho` | `#2A7FFF` |
| LOCKED | `LOCKED 30Â°` | `Angle: Locked 30Â°` | `#1F5EFF` +15% |

**Toastï¼š** ShiftæŒ‰ä¸‹æ—¶æ˜¾ç¤º `ORTHO MODE`ï¼ˆ0.8ç§’ï¼‰

---

## ğŸ¨ CSSæ ¸å¿ƒæ ·å¼

```css
.angle-hud {
  font-size: 14px;
  padding: 4px 8px;
  background: rgba(0,0,0,0.75);
}

.angle-hud-snap {
  color: #2A7FFF;
  font-weight: 600;
  font-size: 16.8px; /* 1.2Ã— */
}

.angle-hud-ortho {
  color: #1F5EFF;
  font-weight: 700;
  font-size: 16.8px;
}

.angle-hud-locked {
  color: #0B5ED7;
  font-weight: 700;
  font-size: 16.8px;
  background: rgba(11,94,215,0.15);
}

.angle-hud-toast {
  font-size: 12px;
  font-weight: 700;
  text-transform: uppercase;
  color: #fff;
  background: rgba(31,94,255,0.9);
  animation: fadeOut 800ms ease-out;
}
```

---

## ğŸ“ æœ‰é—®é¢˜ï¼Ÿ

- æ–‡æ¡ˆé—®é¢˜ â†’ çœ‹å®Œæ•´æ–‡æ¡£ç¬¬2èŠ‚
- ä»£ç é—®é¢˜ â†’ çœ‹å®Œæ•´æ–‡æ¡£ç¬¬4èŠ‚
- éªŒæ”¶é—®é¢˜ â†’ çœ‹å®Œæ•´æ–‡æ¡£ç¬¬7èŠ‚

---

**å¼€å§‹å¹²æ´»ï¼** ğŸš€

å®Œæ•´æ–‡æ¡£ï¼š`2026-02-03_UIè§„èŒƒ_è§’åº¦é”å®šäº¤äº’ä½“éªŒ_CTOæ‰§è¡Œç‰ˆ.md`
