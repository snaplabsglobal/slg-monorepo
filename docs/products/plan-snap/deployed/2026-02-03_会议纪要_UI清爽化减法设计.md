# 会议纪要 - UI清爽化：减法设计

> **会议时间：** 2026-02-03  
> **会议类型：** UI/UX优化决策  
> **参与人员：** CEO、CDO  
> **优先级：** 🟡 P1 - Important  
> **状态：** ✅ 已确定方案

---

## 📋 会议背景

### CEO总体判断

**核心结论：**
> "底层已经对了，但UI噪音太大，正在'出卖手感'。"

**当前状态：**
```
✅ 功能正确
✅ 算法准确
❌ 界面噪音过多
❌ 信息过载
```

**设计阶段：**
```
这是专业绘图软件的"减法"阶段
不是审美问题，是专业性问题
```

**CEO评价：**
> "这一轮反馈非常清晰、而且是'快要像SketchUp了'的那种信号。"

---

## 🎯 核心决策（5项减法）

### 1. 角度提示：只保留30/45/60

#### ❌ 当前问题

**显示了过多角度：**
```
0°
90°
180°
270°
30°
45°
60°
```

**问题分析：**
```
0/90/180/270在建筑绘图里：
- 没有信息量
- 只会制造视觉噪音
- 让用户以为"我是不是要关什么模式"
```

**CEO指出：**
> "正交角本来就是'默认常识'，不需要被提醒。"

---

#### ✅ CEO决策

**角度提示规则：**

**❌ 不显示：**
```
0° / 90° / 180° / 270°
```

**✅ 只显示：**
```
30° / 45° / 60°
```

**未来扩展（如果需要）：**
```
22.5°（Advanced模式）
```

---

#### 实现要点

```typescript
function shouldShowAngleLabel(angleDeg: number): boolean {
  const major = [0, 90, 180, 270]
  if (major.includes(normalize(angleDeg))) return false
  
  return [30, 45, 60].includes(normalize(angleDeg))
}
```

**关键：**
```
UI层直接filter
不动几何逻辑
```

---

### 2. Toolbar的Angle：删掉

#### ❌ 为什么没意义

**用户行为分析：**
```
用户不会：
  在画图前先想"我要切到45°模式"

专业软件逻辑：
  画的时候自动snap
  而不是"先选角度再画"
```

**CEO判断：**
```
这个Angle toolbar属于：
"工程师觉得有用，但用户完全不会点"
```

---

#### ✅ CEO决策

**❌ 移除Angle toolbar**

**✅ Angle只作为：**
```
隐性系统能力
Hover/snap时的反馈
```

**参考SketchUp：**
> "和SketchUp一样：没有Angle面板，但角度永远在那。"

---

### 3. Toolbar的DIM：现在删掉

#### ❌ CEO的疑问

> "DIM是干什么的？如果连CEO都要问，那用户一定更迷糊。"

---

#### 正确的建筑绘图逻辑（非常重要）

**在平面图/施工图早期：**

**❌ 不需要：**
```
"专门进入DIM工具"
点击DIM按钮
切换到标注模式
```

**✅ 应该是：**
```
线画出来 = 就应该知道它多长
长度自然显示
跟随线方向
自动更新
```

---

#### SketchUp/CAD的默认体验

```
画线 → 长度自然显示
需要正式标注时，才进入Dimension工具
```

---

#### ✅ CEO决策（MVP阶段）

**❌ 移除DIM toolbar**

**✅ 当前阶段只做：**
```
线的实际长度标注
跟随线方向
自动更新
```

**未来可以再加：**
```
"正式尺寸标注（可打印）"
作为独立工具
用于生成施工图
```

---

### 4. 尺寸显示规则：干净、真实、克制

#### CEO的专业要求

> "如果是1/16就标1/16，1/4就1/4，要保持界面清爽。"

---

#### ❌ 常见错误（必须避开）

**过度精度：**
```
1.9375"（显示太多小数）
```

**混合显示：**
```
1 15/16 + 0.1mm（不一致）
```

**UI强行补零：**
```
2/16" → 应该简化为 1/8"
0/16" → 根本不应该显示
```

---

#### ✅ CEO尺寸显示规则

**核心原则：**
```
显示 ≠ 几何
```

**内部存储：**
```
全部mm（double）
```

**显示规则：**
```
按snap精度显示
```

---

#### 显示优先级（英制）

| 实际值 | 显示 | 说明 |
|--------|------|------|
| 正好在1/16 | 1/16" | 最简分数 |
| 正好在1/4 | 1/4" | 不显示4/16 |
| 正好在1/2 | 1/2" | 不显示8/16 |
| 正好在整英寸 | 3" | 不显示3 0/16 |
| foot + inch | 3'-0" | 标准格式 |

**关键规则：**
```
✅ 显示精度永远 ≤ snap精度
✅ UI不得暴露计算残差
❌ 不显示多余精度
❌ 不显示0/16、2/16这种垃圾
```

---

#### 给CTO的一句话版本

> "显示精度永远 ≤ snap精度，UI不得暴露计算残差。"

---

### 5. Grid颜色：稍微深一点

#### ❌ 当前问题

**Grid太淡导致：**
```
snap时"没信心"
画线时不稳
缺少"视觉锚点"
```

---

#### ✅ CEO建议

**调整方案：**
```
主grid：不透明度 +10-15%
次grid：保持现状
```

**设计原则：**
```
✅ 不要抢线
✅ 但要给"视觉锚点"
```

---

## ✅ 完成定义（DoD）

### UI Clean-up DoD（可直接交付）

**角度显示：**
- [ ] **只显示30/45/60度**
  - 不显示0/90/180/270
  - UI层filter，不动几何

**Toolbar清理：**
- [ ] **移除Angle toolbar**
  - 角度作为隐性系统能力
  - 只在hover/snap时反馈

- [ ] **移除DIM toolbar（阶段性）**
  - 线默认显示真实长度
  - 跟随线方向
  - 自动更新

**尺寸显示：**
- [ ] **遵循分数最简原则**
  - 显示精度 ≤ snap精度
  - 不显示计算残差
  - 不显示冗余分数（如2/16）

**Grid调整：**
- [ ] **对比度提升10-15%**
  - 主grid稍微深一点
  - 次grid保持不变
  - 不抢线，但给视觉锚点

**验收标准：**
- [ ] **所有UI改动不影响几何精度**
  - 内部仍是mm
  - 算法不变
  - 只改显示

---

## 🔧 技术实现要点

### 1. 角度显示Filter

**位置：** `src/ui/angle-label.tsx` 或类似

**修改：**
```typescript
// 当前（可能）
function renderAngleLabel(angleDeg: number) {
  return <div>{angleDeg}°</div>
}

// 修改为
function renderAngleLabel(angleDeg: number) {
  if (!shouldShowAngleLabel(angleDeg)) return null
  return <div>{angleDeg}°</div>
}

function shouldShowAngleLabel(angleDeg: number): boolean {
  const normalized = ((angleDeg % 360) + 360) % 360
  
  // 过滤正交角
  const orthogonal = [0, 90, 180, 270]
  if (orthogonal.some(a => Math.abs(normalized - a) < 0.1)) {
    return false
  }
  
  // 只显示特殊角
  const special = [30, 45, 60]
  return special.some(a => Math.abs(normalized - a) < 0.1)
}
```

---

### 2. Toolbar清理

**位置：** `src/ui/toolbar.tsx`

**删除：**
```tsx
// ❌ 删除这些
<ToolbarButton icon="angle" ... />
<ToolbarButton icon="dimension" ... />
```

**保留：**
```tsx
// ✅ 保留这些
<ToolbarButton icon="select" ... />
<ToolbarButton icon="line" ... />
<ToolbarButton icon="tape" ... />
<ToolbarButton icon="eraser" ... />
```

---

### 3. 尺寸显示简化

**位置：** `src/utils/format-length.ts`

**关键函数：**
```typescript
function simplifyFraction(numerator: number, denominator: number): string {
  if (numerator === 0) return null
  
  // 最大公约数
  const gcd = (a: number, b: number): number => 
    b ? gcd(b, a % b) : a
  
  const g = gcd(numerator, denominator)
  const num = numerator / g
  const den = denominator / g
  
  // 如果简化后分母是1，不显示分数
  if (den === 1) return null
  
  return `${num}/${den}`
}

function formatLength(
  lenMm: number,
  unitSystem: 'imperial' | 'metric',
  precision: Precision
): string {
  // ... 现有逻辑 ...
  
  // 关键：不显示冗余分数
  const fraction = simplifyFraction(numerator, denominator)
  
  // 不显示 "3 0/16"，应该是 "3""
  if (!fraction) {
    return `${whole}"`
  }
  
  return `${whole} ${fraction}"`
}
```

---

### 4. Grid颜色调整

**位置：** `src/renderer/grid-renderer.ts` 或CSS

**修改：**
```typescript
// 当前（可能）
const GRID_COLOR = 'rgba(0, 0, 0, 0.1)'

// 修改为
const GRID_COLOR = 'rgba(0, 0, 0, 0.15)'  // +50% opacity
// 或
const GRID_COLOR = 'rgba(0, 0, 0, 0.12)'  // +20% opacity
```

**或CSS：**
```css
/* 当前 */
.grid-line {
  stroke: rgba(0, 0, 0, 0.1);
}

/* 修改为 */
.grid-line {
  stroke: rgba(0, 0, 0, 0.15);
}
```

---

## 🎨 UI/UX原则（CEO强调）

### 减法设计的关键

**CEO指出：**
```
这不是审美问题
而是专业绘图软件的"减法"阶段
```

**SketchUp的经验：**
```
没有Angle面板，但角度永远在那
没有多余提示，但功能都能用
```

---

### 信息显示的优先级

**P0（必须显示）：**
```
当前长度（跟随线）
特殊角度（30/45/60）
snap反馈
```

**P1（可选显示）：**
```
grid
辅助线
```

**P2（不显示）：**
```
正交角度（0/90/180/270）
工具状态文字
多余精度
```

---

### 专业工具的克制

**CEO的核心观点：**
> "显示精度永远 ≤ snap精度，UI不得暴露计算残差。"

**翻译：**
```
如果snap精度是1/16"
显示就不应该有1/32"
如果实际是1/4"
就不应该显示4/16"
```

---

## 🧪 测试用例

### TC-U001: 角度显示过滤

**步骤：**
```
1. 画水平线（0°）
2. 画垂直线（90°）
3. 画30°线
4. 画45°线
```

**期望：**
```
0°：不显示角度
90°：不显示角度
30°：显示"30°"
45°：显示"45°"
```

---

### TC-U002: Toolbar简化

**步骤：**
```
1. 打开应用
2. 观察Toolbar
```

**期望：**
```
没有Angle按钮
没有DIM按钮
只有：Select, Line, Tape, Eraser等
```

---

### TC-U003: 尺寸显示简化

**步骤：**
```
1. 画1/4"的线
2. 画2/16"的线
3. 画0.25"的线
```

**期望：**
```
全部显示："1/4""
不显示："2/16"" 或 "0.25""
```

---

### TC-U004: Grid可见性

**步骤：**
```
1. 观察grid
2. 画线时观察snap
```

**期望：**
```
Grid比之前稍微明显
但不抢线的视觉
snap时有"视觉锚点"
```

---

## 💬 CEO关键引用

### 关于总体判断

> "底层已经对了，但UI噪音太大，正在'出卖手感'。"

> "这一轮反馈非常清晰、而且是'快要像SketchUp了'的那种信号。"

---

### 关于角度显示

> "正交角本来就是'默认常识'，不需要被提醒。"

> "和SketchUp一样：没有Angle面板，但角度永远在那。"

---

### 关于DIM工具

> "如果连CEO都要问'DIM是干什么的'，那用户一定更迷糊。"

> "线画出来 = 就应该知道它多长。"

---

### 关于尺寸显示

> "如果是1/16就标1/16，1/4就1/4，要保持界面清爽。"

> "显示精度永远 ≤ snap精度，UI不得暴露计算残差。"

---

### 关于减法设计

> "这不是审美问题，而是专业绘图软件的'减法'阶段。"

---

## 📋 行动项

### CTO立即执行

**优先级：** 🟡 P1（不紧急，但重要）

**工作量：** 0.5-1天

**任务：**
- [ ] 角度显示filter（0.5小时）
- [ ] 删除Angle toolbar（0.5小时）
- [ ] 删除DIM toolbar（0.5小时）
- [ ] 尺寸显示简化（1小时）
- [ ] Grid颜色调整（0.5小时）
- [ ] 测试和验收（1小时）

---

### CDO配合工作

**任务：**
- [ ] 创建快速执行清单
- [ ] 更新决策日志
- [ ] 更新文档索引

---

### CEO验收

**验收标准：**
- [ ] 打开应用，观察UI
- [ ] 画几条线，观察标注
- [ ] 感受整体"清爽度"

**验收问题：**
```
1. 看到0°/90°了吗？（应该：没有）
2. Toolbar干净了吗？（应该：是的）
3. 标注清爽了吗？（应该：是的）
4. Grid合适了吗？（应该：是的）
```

---

## 🔗 相关文档

**本次会议产出：**
1. 本会议纪要
2. 快速执行清单（待创建）

**相关历史文档：**
1. 角度锁定UI/UX规范（DEC-004）
2. 标注系统精度和交互（DEC-007）

---

## 🎯 总结

这次会议是"减法设计"的典型案例：

**不是增加功能，而是减少噪音**

**5个关键决策：**
1. 角度：只显示30/45/60
2. Angle toolbar：删掉
3. DIM toolbar：删掉（阶段性）
4. 尺寸：干净、真实、克制
5. Grid：稍微深一点

**CEO的核心观点：**
> "底层已经对了，但UI噪音太大。这不是审美问题，而是专业性问题。"

这是PlanSnap走向SketchUp级别专业工具的重要一步！🚀

---

**会议记录人：** CDO  
**会议时间：** 2026-02-03  
**下次Review：** UI清爽化完成后  
**状态：** ✅ 方案已确定，待执行
