# Gemini 500 é”™è¯¯ - P0 ç´§æ€¥ä¿®å¤æŒ‡å—

> **ä¼˜å…ˆçº§ï¼š** P0ï¼ˆç´§æ€¥ï¼Œé˜»å¡æ ¸å¿ƒåŠŸèƒ½ï¼‰  
> **é—®é¢˜ï¼š** Gemini API è¿”å› 500 é”™è¯¯ï¼Œå¯¼è‡´ receipt æ— æ³•è¯†åˆ«  
> **é¢„ä¼°å·¥ä½œé‡ï¼š** 2-3 å°æ—¶  
> **ä»»åŠ¡ç±»å‹ï¼š** Bug ä¿®å¤

---

## ğŸ¯ å¿«é€Ÿæ‘˜è¦ï¼ˆ1åˆ†é’Ÿï¼‰

### é—®é¢˜ç°è±¡
```
ä¸Šä¼  receipt åï¼š
- Vendor: "Analyzing..."
- Date: "Analyzing..."
- Total: "Analyzing..."
- æ— æ³•è·³è½¬åˆ°åˆ—è¡¨
- Console: POST /api/transactions/{id}/analyze 500
```

### æ ¹æœ¬åŸå› 
Gemini API è¿”å›çš„ JSON æ ¼å¼ä¸æ ‡å‡†ï¼Œå¯¼è‡´è§£æå¤±è´¥ã€‚

**å¯èƒ½çš„åŸå› ï¼š**
1. Gemini è¿”å› markdown-wrapped JSONï¼ˆ```json ... ```ï¼‰
2. Gemini è¿”å›çš„ JSON å‰åæœ‰é¢å¤–æ–‡æœ¬
3. Gemini è¿”å›äº†éæ ‡å‡†æ ¼å¼

### ä¿®å¤æ–¹æ¡ˆ
1. åŠ å¼º Gemini promptï¼ˆæ˜ç¡®ç¦æ­¢ markdownï¼‰
2. æ”¹è¿› JSON è§£æå™¨ï¼ˆå®¹é”™å¤„ç†ï¼‰
3. æ·»åŠ é‡è¯•é€»è¾‘ï¼ˆå¤±è´¥è‡ªåŠ¨é‡è¯•ï¼‰

---

## ğŸ“‹ ä¿®å¤æ¸…å•

### âœ… Task 1: åŠ å¼º Gemini Promptï¼ˆ30minï¼‰
- [ ] ä¿®æ”¹ analyze/route.ts çš„ prompt
- [ ] æ·»åŠ ä¸¥æ ¼çš„æ ¼å¼è¦æ±‚
- [ ] æµ‹è¯•éªŒè¯

### âœ… Task 2: æ”¹è¿› JSON è§£æå™¨ï¼ˆ1hï¼‰
- [ ] åˆ›å»º parseGeminiJson.ts
- [ ] å®ç°å®¹é”™è§£æé€»è¾‘
- [ ] æ·»åŠ è¯¦ç»†é”™è¯¯æ—¥å¿—
- [ ] é›†æˆåˆ° analyze è·¯ç”±

### âœ… Task 3: æ·»åŠ é‡è¯•é€»è¾‘ï¼ˆ1hï¼‰
- [ ] ä¿®æ”¹ analyze-worker.ts
- [ ] å®ç° 3 æ¬¡é‡è¯•æœºåˆ¶
- [ ] æ·»åŠ é€’å¢å»¶è¿Ÿ
- [ ] æœ€ç»ˆå¤±è´¥æ ‡è®°ä¸º blocked

### âœ… Task 4: æµ‹è¯•éªŒè¯ï¼ˆ30minï¼‰
- [ ] ä¸Šä¼ æ­£å¸¸ receipt
- [ ] ä¸Šä¼ å¤æ‚ receipt
- [ ] éªŒè¯é‡è¯•æœºåˆ¶
- [ ] æŸ¥çœ‹é”™è¯¯æ—¥å¿—

---

## ğŸ”§ Task 1: åŠ å¼º Gemini Promptï¼ˆ30minï¼‰

### æ–‡ä»¶ä½ç½®
```
apps/api/src/routes/analyze/route.ts
```

### ä¿®æ”¹å†…å®¹

**æ‰¾åˆ° Gemini prompt æ„å»ºçš„åœ°æ–¹ï¼Œåœ¨æœ«å°¾æ·»åŠ ï¼š**

```typescript
// apps/api/src/routes/analyze/route.ts

const prompt = `
${existingPrompt}

---
CRITICAL OUTPUT FORMAT REQUIREMENTS:

1. You MUST respond ONLY with valid JSON
2. NO markdown code fences - Do NOT use \`\`\`json or \`\`\`
3. NO explanations before or after the JSON
4. NO comments inside the JSON
5. Start directly with { and end with }

Example of CORRECT format:
{
  "vendor_name": "The Home Depot",
  "transaction_date": "2024-06-04",
  "total": 57.53,
  "subtotal": 51.36,
  "gst": 2.57,
  "pst": 3.60,
  "category": "Materials & Supplies",
  "confidence": 0.95
}

Example of INCORRECT format (DO NOT DO THIS):
\`\`\`json
{
  "vendor_name": "The Home Depot"
}
\`\`\`

REMEMBER: Just pure JSON, nothing else!
`;
```

**å…³é”®ç‚¹ï¼š**
- æ˜ç¡®ç¦æ­¢ markdown fences
- æä¾›æ­£ç¡®/é”™è¯¯ç¤ºä¾‹
- å¼ºè°ƒ"pure JSON, nothing else"

---

## ğŸ”§ Task 2: æ”¹è¿› JSON è§£æå™¨ï¼ˆ1hï¼‰

### Step 2.1: åˆ›å»ºè§£æå™¨æ–‡ä»¶

**æ–‡ä»¶ä½ç½®ï¼š**
```
apps/api/src/lib/parseGeminiJson.ts
```

**å®Œæ•´ä»£ç ï¼š**

```typescript
/**
 * è§£æ Gemini è¿”å›çš„ JSONï¼Œå®¹é”™å¤„ç†å„ç§æ ¼å¼é—®é¢˜
 */
export function parseGeminiJson(text: string): any {
  if (!text || typeof text !== 'string') {
    throw new Error('Invalid input: text is required and must be a string');
  }

  // Step 1: å»é™¤ markdown code fences
  let cleaned = text
    .replace(/```json\n?/g, '')  // å»é™¤ ```json
    .replace(/```\n?/g, '')       // å»é™¤ ```
    .trim();

  // Step 2: ç¬¬ä¸€æ¬¡å°è¯•è§£æ
  try {
    return JSON.parse(cleaned);
  } catch (firstError) {
    console.warn('First parse attempt failed, trying to extract JSON object...');
    
    // Step 3: å°è¯•æå– JSON å¯¹è±¡ï¼ˆå¤„ç†å‰åæœ‰é¢å¤–æ–‡æœ¬çš„æƒ…å†µï¼‰
    const jsonMatch = cleaned.match(/\{[\s\S]*\}/);
    
    if (jsonMatch) {
      try {
        return JSON.parse(jsonMatch[0]);
      } catch (secondError) {
        console.error('Second parse attempt also failed');
      }
    }
    
    // Step 4: å°è¯•ä»ç¬¬ä¸€ä¸ª { åˆ°æœ€åä¸€ä¸ª }
    const firstBrace = cleaned.indexOf('{');
    const lastBrace = cleaned.lastIndexOf('}');
    
    if (firstBrace !== -1 && lastBrace !== -1 && lastBrace > firstBrace) {
      const extracted = cleaned.substring(firstBrace, lastBrace + 1);
      try {
        return JSON.parse(extracted);
      } catch (thirdError) {
        console.error('Third parse attempt also failed');
      }
    }
    
    // Step 5: æ‰€æœ‰å°è¯•éƒ½å¤±è´¥ï¼Œè®°å½•è¯¦ç»†é”™è¯¯
    console.error('===== Gemini JSON Parse Error =====');
    console.error('Original text length:', text.length);
    console.error('Original text preview:', text.substring(0, 200));
    console.error('Cleaned text:', cleaned);
    console.error('First error:', firstError.message);
    console.error('===================================');
    
    throw new Error(
      `Failed to parse Gemini response as JSON. ` +
      `Original error: ${firstError.message}. ` +
      `Response preview: ${text.substring(0, 100)}...`
    );
  }
}

/**
 * éªŒè¯è§£æåçš„æ•°æ®æ˜¯å¦åŒ…å«å¿…éœ€å­—æ®µ
 */
export function validateParsedData(data: any): void {
  if (!data || typeof data !== 'object') {
    throw new Error('Parsed data is not an object');
  }

  // å¯é€‰ï¼šæ·»åŠ å­—æ®µéªŒè¯
  // const requiredFields = ['vendor_name', 'total'];
  // for (const field of requiredFields) {
  //   if (!(field in data)) {
  //     throw new Error(`Missing required field: ${field}`);
  //   }
  // }
}
```

---

### Step 2.2: é›†æˆåˆ° analyze è·¯ç”±

**æ–‡ä»¶ä½ç½®ï¼š**
```
apps/api/src/routes/analyze/route.ts
```

**ä¿®æ”¹å†…å®¹ï¼š**

```typescript
// åœ¨æ–‡ä»¶é¡¶éƒ¨æ·»åŠ  import
import { parseGeminiJson, validateParsedData } from '@/lib/parseGeminiJson';

// æ‰¾åˆ°è°ƒç”¨ Gemini çš„åœ°æ–¹ï¼Œä¿®æ”¹è§£æé€»è¾‘
// å°†åŸæ¥çš„ï¼š
// const data = JSON.parse(geminiResponse);

// æ”¹ä¸ºï¼š
try {
  const data = parseGeminiJson(geminiResponse);
  
  // å¯é€‰ï¼šéªŒè¯æ•°æ®
  validateParsedData(data);
  
  // ç»§ç»­å¤„ç†...
  
} catch (error) {
  console.error('Failed to parse Gemini response:', error);
  
  // æ›´æ–° transaction çŠ¶æ€ä¸º error
  await updateTransaction(transactionId, {
    status: 'error',
    error_message: error.message
  });
  
  throw error;
}
```

---

## ğŸ”§ Task 3: æ·»åŠ é‡è¯•é€»è¾‘ï¼ˆ1hï¼‰

### æ–‡ä»¶ä½ç½®
```
apps/api/src/workers/analyze-worker.ts
æˆ–ç±»ä¼¼çš„ worker æ–‡ä»¶
```

### ä¿®æ”¹å†…å®¹

**Step 3.1: æ·»åŠ  sleep è¾…åŠ©å‡½æ•°**

```typescript
/**
 * å»¶è¿Ÿæ‰§è¡Œ
 */
function sleep(ms: number): Promise<void> {
  return new Promise(resolve => setTimeout(resolve, ms));
}
```

---

**Step 3.2: åˆ›å»ºå¸¦é‡è¯•çš„åˆ†æå‡½æ•°**

```typescript
/**
 * å¸¦é‡è¯•æœºåˆ¶çš„åˆ†æå‡½æ•°
 */
async function analyzeWithRetry(
  transactionId: string,
  maxRetries: number = 3
): Promise<any> {
  let lastError: Error | null = null;
  
  for (let attempt = 0; attempt < maxRetries; attempt++) {
    try {
      console.log(`[Analyze] Attempt ${attempt + 1}/${maxRetries} for transaction ${transactionId}`);
      
      // è°ƒç”¨å®é™…çš„åˆ†æå‡½æ•°
      const result = await analyzeTransaction(transactionId);
      
      console.log(`[Analyze] Success on attempt ${attempt + 1}`);
      return result;
      
    } catch (error) {
      lastError = error as Error;
      console.error(`[Analyze] Attempt ${attempt + 1} failed:`, error.message);
      
      // å¦‚æœæ˜¯æœ€åä¸€æ¬¡å°è¯•ï¼Œä¸å†é‡è¯•
      if (attempt === maxRetries - 1) {
        console.error(`[Analyze] All ${maxRetries} attempts failed for ${transactionId}`);
        break;
      }
      
      // é€’å¢å»¶è¿Ÿï¼š5s, 10s, 15s
      const delayMs = 5000 * (attempt + 1);
      console.log(`[Analyze] Retrying in ${delayMs}ms...`);
      await sleep(delayMs);
    }
  }
  
  // æ‰€æœ‰é‡è¯•éƒ½å¤±è´¥
  // æ›´æ–° transaction çŠ¶æ€ä¸º blocked
  try {
    await updateTransactionStatus(transactionId, 'blocked', {
      error: 'Analysis failed after multiple retries',
      last_error: lastError?.message,
      retry_count: maxRetries
    });
  } catch (updateError) {
    console.error('Failed to update transaction status:', updateError);
  }
  
  throw new Error(
    `Analysis failed after ${maxRetries} attempts. Last error: ${lastError?.message}`
  );
}
```

---

**Step 3.3: æ›¿æ¢åŸæœ‰çš„åˆ†æè°ƒç”¨**

```typescript
// æ‰¾åˆ°è°ƒç”¨ analyzeTransaction çš„åœ°æ–¹
// å°†ï¼š
// await analyzeTransaction(transactionId);

// æ”¹ä¸ºï¼š
await analyzeWithRetry(transactionId, 3);
```

---

**Step 3.4: æ·»åŠ çŠ¶æ€æ›´æ–°å‡½æ•°ï¼ˆå¦‚æœä¸å­˜åœ¨ï¼‰**

```typescript
/**
 * æ›´æ–° transaction çŠ¶æ€
 */
async function updateTransactionStatus(
  transactionId: string,
  status: string,
  metadata?: Record<string, any>
): Promise<void> {
  await db.transactions.update(
    { id: transactionId },
    {
      status,
      error_message: metadata?.error || null,
      updated_at: new Date()
    }
  );
}
```

---

## ğŸ§ª Task 4: æµ‹è¯•éªŒè¯ï¼ˆ30minï¼‰

### æµ‹è¯•æ¸…å•

#### æµ‹è¯• 1: æ­£å¸¸ Receipt

**æ“ä½œï¼š**
1. ä¸Šä¼ ä¸€å¼ æ¸…æ™°çš„ receipt
2. ç­‰å¾…åˆ†æå®Œæˆ

**é¢„æœŸç»“æœï¼š**
- âœ… æˆåŠŸè¯†åˆ« vendor, date, total
- âœ… è‡ªåŠ¨è·³è½¬åˆ°åˆ—è¡¨
- âœ… Console æ—  500 é”™è¯¯

---

#### æµ‹è¯• 2: å¤æ‚ Receipt

**æ“ä½œï¼š**
1. ä¸Šä¼ ä¸€å¼ å¤æ‚çš„ receiptï¼ˆå¦‚é€€è´§ã€å¤šç¨ç§ç­‰ï¼‰
2. ç­‰å¾…åˆ†æå®Œæˆ

**é¢„æœŸç»“æœï¼š**
- âœ… æˆåŠŸè¯†åˆ«ï¼ˆæˆ–è¿›å…¥ needs_reviewï¼‰
- âœ… å¦‚æœé¦–æ¬¡å¤±è´¥ï¼Œè‡ªåŠ¨é‡è¯•
- âœ… Console æ˜¾ç¤ºé‡è¯•æ—¥å¿—

---

#### æµ‹è¯• 3: æŸ¥çœ‹é‡è¯•æ—¥å¿—

**æ“ä½œï¼š**
1. ä¸Šä¼  receipt
2. æŸ¥çœ‹ Console æˆ–æœåŠ¡å™¨æ—¥å¿—

**é¢„æœŸæ—¥å¿—ï¼š**
```
[Analyze] Attempt 1/3 for transaction xxx
[Analyze] Success on attempt 1

æˆ–è€…ï¼ˆå¦‚æœå¤±è´¥ï¼‰ï¼š

[Analyze] Attempt 1/3 for transaction xxx
[Analyze] Attempt 1 failed: ...
[Analyze] Retrying in 5000ms...
[Analyze] Attempt 2/3 for transaction xxx
[Analyze] Success on attempt 2
```

---

#### æµ‹è¯• 4: Gemini å“åº”æ—¥å¿—

**æ“ä½œï¼š**
1. ä¸Šä¼  receipt
2. æŸ¥çœ‹è§£æå™¨çš„è¯¦ç»†æ—¥å¿—

**é¢„æœŸæ—¥å¿—ï¼ˆå¦‚æœå‡ºé”™ï¼‰ï¼š**
```
===== Gemini JSON Parse Error =====
Original text length: 250
Original text preview: ```json
{"vendor_name": "..."}
```
Cleaned text: {"vendor_name": "..."}
First error: Unexpected token ...
===================================
```

**è¿™äº›æ—¥å¿—å¯ä»¥å¸®åŠ©è¯Šæ–­å…·ä½“é—®é¢˜**

---

## ğŸ› å¸¸è§é—®é¢˜æ’æŸ¥

### Q1: ä¿®æ”¹åä»ç„¶ 500 é”™è¯¯

**æ’æŸ¥æ­¥éª¤ï¼š**

1. **æ£€æŸ¥ parseGeminiJson æ˜¯å¦æ­£ç¡®å¯¼å…¥**
   ```typescript
   import { parseGeminiJson } from '@/lib/parseGeminiJson';
   ```

2. **æ£€æŸ¥æ˜¯å¦åœ¨æ­£ç¡®çš„åœ°æ–¹è°ƒç”¨**
   ```typescript
   // åº”è¯¥åœ¨è¿™é‡Œè°ƒç”¨
   const data = parseGeminiJson(geminiResponse);
   ```

3. **æŸ¥çœ‹è¯¦ç»†é”™è¯¯æ—¥å¿—**
   ```
   Console ä¸­æœç´¢ "Gemini JSON Parse Error"
   ```

---

### Q2: é‡è¯•é€»è¾‘ä¸å·¥ä½œ

**æ’æŸ¥æ­¥éª¤ï¼š**

1. **æ£€æŸ¥æ˜¯å¦æ›¿æ¢äº†è°ƒç”¨**
   ```typescript
   // ç¡®ä¿ä½¿ç”¨äº† analyzeWithRetry
   await analyzeWithRetry(transactionId, 3);
   ```

2. **æŸ¥çœ‹é‡è¯•æ—¥å¿—**
   ```
   Console ä¸­æœç´¢ "[Analyze] Attempt"
   ```

3. **æ£€æŸ¥ worker æ˜¯å¦é‡å¯**
   ```bash
   # é‡å¯ API æœåŠ¡
   npm run dev
   ```

---

### Q3: è§£ææˆåŠŸä½†æ•°æ®ä¸å¯¹

**æ’æŸ¥æ­¥éª¤ï¼š**

1. **æ·»åŠ æ•°æ®éªŒè¯**
   ```typescript
   validateParsedData(data);
   ```

2. **æ£€æŸ¥ Gemini prompt**
   ```
   ç¡®ä¿ prompt æ˜ç¡®è¦æ±‚äº†æ‰€æœ‰å¿…éœ€å­—æ®µ
   ```

3. **æŸ¥çœ‹å®é™…è§£æç»“æœ**
   ```typescript
   console.log('Parsed data:', JSON.stringify(data, null, 2));
   ```

---

## ğŸ“‚ æ¶‰åŠçš„æ–‡ä»¶

### æ–°å»ºæ–‡ä»¶
```
apps/api/src/lib/parseGeminiJson.ts  â† æ–°å»º
```

### ä¿®æ”¹æ–‡ä»¶
```
apps/api/src/routes/analyze/route.ts
apps/api/src/workers/analyze-worker.ts  â† å¦‚æœæœ‰çš„è¯
```

---

## âœ… éªŒæ”¶æ ‡å‡†

### åŠŸèƒ½éªŒæ”¶
- [ ] ä¸Šä¼ æ­£å¸¸ receipt æˆåŠŸè¯†åˆ«
- [ ] ä¸Šä¼ å¤æ‚ receipt æˆåŠŸè¯†åˆ«æˆ–è¿›å…¥ needs_review
- [ ] è¯†åˆ«å¤±è´¥è‡ªåŠ¨é‡è¯•ï¼ˆæœ€å¤š 3 æ¬¡ï¼‰
- [ ] 3 æ¬¡å¤±è´¥åæ ‡è®°ä¸º blocked
- [ ] Console æ—  500 é”™è¯¯ï¼ˆæˆ–æœ‰è¯¦ç»†é”™è¯¯æ—¥å¿—ï¼‰

### æ—¥å¿—éªŒæ”¶
- [ ] èƒ½çœ‹åˆ°é‡è¯•æ—¥å¿—
- [ ] èƒ½çœ‹åˆ° Gemini å“åº”é¢„è§ˆ
- [ ] èƒ½çœ‹åˆ°è§£æé”™è¯¯è¯¦æƒ…
- [ ] èƒ½æ ¹æ®æ—¥å¿—å¿«é€Ÿå®šä½é—®é¢˜

---

## ğŸš€ å®æ–½å»ºè®®

### æ¨èé¡ºåº

**Step 1: å…ˆå®æ–½è§£æå™¨ï¼ˆæœ€é‡è¦ï¼‰**
- Task 2: æ”¹è¿› JSON è§£æå™¨
- æµ‹è¯•ï¼šä¸Šä¼  receiptï¼ŒæŸ¥çœ‹æ˜¯å¦è§£å†³

**Step 2: å¦‚æœè¿˜æœ‰é—®é¢˜ï¼ŒåŠ å¼º prompt**
- Task 1: åŠ å¼º Gemini Prompt
- æµ‹è¯•ï¼šå†æ¬¡ä¸Šä¼ 

**Step 3: æ·»åŠ é‡è¯•é€»è¾‘ï¼ˆå¢å¼ºç¨³å®šæ€§ï¼‰**
- Task 3: æ·»åŠ é‡è¯•é€»è¾‘
- æµ‹è¯•ï¼šéªŒè¯é‡è¯•æœºåˆ¶

**ä¸ºä»€ä¹ˆè¿™ä¸ªé¡ºåºï¼Ÿ**
- è§£æå™¨èƒ½ç«‹å³è§£å†³å¤§éƒ¨åˆ†é—®é¢˜
- Prompt ä¼˜åŒ–éœ€è¦ Gemini é‡æ–°å“åº”
- é‡è¯•æ˜¯é”¦ä¸Šæ·»èŠ±ï¼Œæé«˜æˆåŠŸç‡

---

## ğŸ’¬ ç»™ Cursor çš„å®Œæ•´æ¶ˆæ¯

**æ¨èè¿™æ ·å‘ç»™ Cursorï¼š**

```
å˜¿ Cursorï¼Œæœ‰ä¸ª P0 ç´§æ€¥é—®é¢˜éœ€è¦ç«‹å³ä¿®å¤ï¼

é—®é¢˜ï¼šGemini API è¿”å› 500 é”™è¯¯
å½±å“ï¼šreceipt æ— æ³•è¯†åˆ«ï¼Œæ‰€æœ‰ä¸Šä¼ éƒ½å¤±è´¥
ä¼˜å…ˆçº§ï¼šP0ï¼ˆç´§æ€¥ï¼Œé˜»å¡æ ¸å¿ƒåŠŸèƒ½ï¼‰

ä¿®å¤æ–¹æ¡ˆï¼š
æŒ‰ç…§ "Gemini 500 é”™è¯¯ - P0 ç´§æ€¥ä¿®å¤æŒ‡å—" å®æ–½

æ¨èé¡ºåºï¼š
1. Task 2: æ”¹è¿› JSON è§£æå™¨ï¼ˆæœ€é‡è¦ï¼Œå…ˆåšè¿™ä¸ªï¼‰
2. Task 1: åŠ å¼º Gemini Promptï¼ˆå¦‚æœè¿˜æœ‰é—®é¢˜ï¼‰
3. Task 3: æ·»åŠ é‡è¯•é€»è¾‘ï¼ˆå¢å¼ºç¨³å®šæ€§ï¼‰

æ¯ä¸ª Task éƒ½æœ‰ï¼š
- è¯¦ç»†çš„æ–‡ä»¶ä½ç½®
- å®Œæ•´çš„ä»£ç ç¤ºä¾‹
- æµ‹è¯•éªŒè¯æ–¹æ³•

å¦‚æœé‡åˆ°é—®é¢˜ï¼ŒæŸ¥çœ‹"å¸¸è§é—®é¢˜æ’æŸ¥"éƒ¨åˆ†ã€‚

å¼€å§‹å‰è¯·ç¡®è®¤ï¼š
- P2 ä¼˜åŒ–å·²å®Œæˆ âœ…
- ç°åœ¨ä¸“æ³¨ P0 ä¿®å¤

é¢„ä¼°æ—¶é—´ï¼š2-3 å°æ—¶

å®Œæˆåæµ‹è¯•ï¼šä¸Šä¼ å‡ å¼  receiptï¼Œç¡®ä¿éƒ½èƒ½æˆåŠŸè¯†åˆ«ã€‚
```

---

## ğŸ“Š ä¼˜å…ˆçº§è¯´æ˜

### ä¸ºä»€ä¹ˆæ˜¯ P0ï¼Ÿ

| å½±å“ | è¯´æ˜ |
|------|------|
| **åŠŸèƒ½é˜»å¡** | ç”¨æˆ·æ— æ³•ä¸Šä¼  receipt |
| **æ ¸å¿ƒæµç¨‹** | è¿™æ˜¯äº§å“çš„æ ¸å¿ƒåŠŸèƒ½ |
| **ç”¨æˆ·ä½“éªŒ** | æ¯æ¬¡ä¸Šä¼ éƒ½å¤±è´¥ = äº§å“ä¸å¯ç”¨ |
| **ä¸šåŠ¡å½±å“** | ä¼šè®¡æ— æ³•å·¥ä½œ |

### P0 vs P2 çš„åŒºåˆ«

| ç±»å‹ | P0 | P2 |
|------|----|----|
| **æ€§è´¨** | Bug ä¿®å¤ | ä½“éªŒä¼˜åŒ– |
| **å½±å“** | é˜»å¡æ ¸å¿ƒåŠŸèƒ½ | æ”¹å–„ç”¨æˆ·ä½“éªŒ |
| **ç´§æ€¥ç¨‹åº¦** | ç«‹å³ä¿®å¤ | å¯ä»¥æ’æœŸ |
| **ç¤ºä¾‹** | Gemini 500 | Notes å­—æ®µ |

---

## ğŸ“ å­¦ä¹ ç‚¹

### è¿™æ¬¡é—®é¢˜çš„å¯ç¤º

**äº§å“å¼€å‘çš„ä¼˜å…ˆçº§ï¼š**
1. âœ… **P0: æ ¸å¿ƒåŠŸèƒ½å¯ç”¨**ï¼ˆè¯†åˆ« receiptï¼‰
2. âœ… **P1: é‡è¦åŠŸèƒ½å®Œå–„**ï¼ˆçŠ¶æ€æ˜¾ç¤ºã€é€€è´§ï¼‰
3. âœ… **P2: ä½“éªŒä¼˜åŒ–**ï¼ˆNotesã€Projectã€ç¼©æ”¾ï¼‰

**æ­£ç¡®çš„é¡ºåºï¼š**
```
å…ˆè®©åŠŸèƒ½èƒ½ç”¨ï¼ˆP0ï¼‰
â†’ å†è®©åŠŸèƒ½å¥½ç”¨ï¼ˆP1ï¼‰
â†’ æœ€åè®©åŠŸèƒ½å¾ˆå¥½ç”¨ï¼ˆP2ï¼‰
```

**é”™è¯¯çš„é¡ºåºï¼š**
```
âŒ ç›´æ¥åš P2 ä¼˜åŒ–
   ä½† P0 åŠŸèƒ½éƒ½ä¸èƒ½ç”¨
   = æˆ¿å­è¿˜æ²¡ç›–å¥½å°±è£…ä¿®
```

---

**ç‰ˆæœ¬ï¼š** v1.0  
**åˆ›å»ºæ—¶é—´ï¼š** 2026-02-01  
**è´Ÿè´£äººï¼š** CDO (Claude Web AI)  
**ä»»åŠ¡çŠ¶æ€ï¼š** å¾…å®æ–½  
**ç´§æ€¥ç¨‹åº¦ï¼š** ğŸ”´ P0 ç´§æ€¥

---

**é¢„ä¼°å®Œæˆæ—¶é—´ï¼š** ä»Šå¤©ï¼ˆ2-3 å°æ—¶ï¼‰

**è®°ä½ï¼šè¿™æ˜¯ P0 ä»»åŠ¡ï¼Œç«‹å³å¼€å§‹ï¼** ğŸš¨
