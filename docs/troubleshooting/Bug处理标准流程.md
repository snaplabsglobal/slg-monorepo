# 🐛 Bug 处理标准流程快速参考

> **根据《AI 协作与决策规范 v1.1》**  
> **使用场景：** 遇到任何技术错误/Bug 时  
> **预计时间：** 10-30 分钟完整流程

---

## 🎯 一图看懂

```
【发现 Bug】
    ↓
【判断类型】→ 是情况 A：AI 未自动触发 / 状态异常
    ↓
【CTO 诊断】→ Claude Code 分析根因
    ↓
【工程修复】→ Cursor 改代码
    ↓
【CPO 评估】→ GPT 评估会计影响
    ↓
【CDO 记录】→ Claude Web 归档文档
    ↓
【验收确认】→ 测试通过，问题关闭
```

---

## 📋 标准步骤详解

### Step 1: 发现并判断（你 - CEO/发现者）⏱️ 1分钟

**做什么：**
- 截图/复制错误信息
- 判断是哪种情况（A/B/C）

**对于技术错误：** 选择「情况 A」

---

### Step 2: CTO 诊断根因 ⏱️ 5-10分钟

**找谁：** Claude Code（CTO）

**怎么问：**
```
【错误信息】[粘贴错误]
【错误位置】/path/to/file.tsx line X
【问题】这是什么问题？为什么会出现？有系统性风险吗？
```

**CTO 会告诉你：**
- ✅ 问题根因
- ✅ 影响范围
- ✅ 修复建议
- ✅ 是否有连带问题

---

### Step 3: 工程修复代码 ⏱️ 5-15分钟

**找谁：** Cursor（工程）

**怎么做：**
1. 按 CTO 的建议修改代码
2. 本地测试
3. 确认修复有效

**检查清单：**
- [ ] 代码已修改
- [ ] 编译通过
- [ ] 本地测试通过
- [ ] 没有引入新问题

---

### Step 4: CPO 评估影响 ⏱️ 2-5分钟

**找谁：** GPT（CPO）

**怎么问：**
```
这个 bug 会影响会计的哪些功能？
严重程度如何？需要通知用户吗？
```

**CPO 会告诉你：**
- 会计可用性影响
- 优先级评估（P0/P1/P2）
- 是否需要紧急修复

---

### Step 5: CDO 记录归档 ⏱️ 5-10分钟

**找谁：** Claude Web（CDO，也就是我）

**怎么做：**
```
帮我记录这个 bug：
- 错误信息：XXX
- CTO 分析：YYY
- 修复方案：ZZZ
- CPO 评估：AAA
```

**CDO 会创建：**
- 问题记录文档
- 归档到 `troubleshooting/`
- 更新已知问题 FAQ（如果必要）

---

### Step 6: 验收确认 ⏱️ 5分钟

**谁来做：** CEO + CPO

**检查内容：**
- [ ] 功能正常工作
- [ ] 会计体验符合预期
- [ ] 没有副作用

**通过后：** 标记问题为「已解决」✅

---

## 🚦 优先级判断

| 严重程度 | 特征 | 响应时间 | 示例 |
|---------|------|---------|------|
| 🔴 **P0 - 紧急** | 阻塞核心功能<br>影响所有用户 | 立即处理<br>（1小时内） | 构建失败<br>无法登录<br>数据丢失 |
| 🟠 **P1 - 高** | 影响重要功能<br>影响部分用户 | 当天处理<br>（8小时内） | 某功能报错<br>性能严重下降 |
| 🟡 **P2 - 中** | 影响次要功能<br>有替代方案 | 本周处理<br>（2-3天） | UI 显示异常<br>小功能不可用 |
| 🟢 **P3 - 低** | 不影响功能<br>美化改进 | 排期处理<br>（1-2周） | 文案错误<br>样式微调 |

---

## 💡 你这个 Bug 的快速处理方案

### 问题：TypeScript 语法错误

**优先级：** 🔴 P0（阻塞构建）

**快速修复：**

1. **找到文件：** `/app/components/transactions/TransactionsTable.tsx`

2. **定位到 line 58：**
```typescript
// ❌ 错误
const statusLabel = dbStatus === 'approved' ? ✓ $(DB_LABEL(dbStatus) ?? dbStatus

// ✅ 修复（加括号）
const statusLabel = dbStatus === 'approved' ? ✓ $((DB_LABEL(dbStatus) ?? dbStatus))
```

3. **测试：**
```bash
npm run build  # 确认构建通过
npm run dev    # 测试功能
```

4. **提交：**
```bash
git add .
git commit -m "fix: add parens for nullish coalescing operator"
git push
```

---

## 📞 找谁咨询

### 技术问题
- **CTO** (Claude Code)：架构、系统、风险
- **工程** (Cursor)：代码实现、修复

### 产品问题
- **CPO** (GPT)：会计接受度、功能影响
- **COO** (Gemini 3)：优先级、节奏

### 文档记录
- **CDO** (Claude Web)：整理、归档、知识库

---

## 🔄 常见问题

**Q: 我不确定这是什么类型的问题，怎么办？**  
A: 直接问 CTO，CTO 会帮你判断

**Q: Bug 很紧急，可以跳过某些步骤吗？**  
A: P0 级别可以先修复再记录，但记录不能省

**Q: 如果 CTO 和 CPO 意见不一致怎么办？**  
A: 最终由 CEO/COO（人）拍板

**Q: 我自己修好了，还需要走流程吗？**  
A: 需要！至少要让 CDO 记录下来，避免重复踩坑

---

## 📝 模板速查

### 向 CTO 报告 Bug
```
【错误类型】构建错误/运行时错误/逻辑错误
【错误位置】/path/to/file.tsx line X
【错误信息】[粘贴完整错误]
【复现步骤】1. 2. 3.
【期望行为】应该怎样
【实际行为】实际怎样
```

### 向 CPO 评估影响
```
【Bug 描述】简短描述
【影响功能】哪些功能不可用
【影响用户】会计/管理员/所有人
【是否阻塞】是否影响核心流程
```

### 向 CDO 记录问题
```
【问题】简短描述
【根因】CTO 分析结果
【修复】修复方案
【影响】CPO 评估结果
【预防】如何避免再次发生
```

---

## ✅ 检查清单

问题解决前，确认这些都完成了：

- [ ] CTO 已诊断根因
- [ ] Cursor 已修复代码
- [ ] CPO 已评估影响
- [ ] 本地测试通过
- [ ] 代码已提交
- [ ] CDO 已记录文档
- [ ] CEO 已验收确认

**全部打勾 → 问题关闭！** ✅

---

**版本：** v1.0  
**更新日期：** 2025-02-01  
**维护者：** CDO (Claude Web AI)  
**相关规范：** [AI 协作与决策规范 v1.1](./JSS_LedgerSnap_AI协作与决策规范_v1.1.md)
