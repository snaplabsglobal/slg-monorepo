# LedgerSnap MVP - æŠ€æœ¯è§„æ ¼æ–‡æ¡£

**ç‰ˆæœ¬**: 1.0  
**æ—¥æœŸ**: 2026-01-27  
**çŠ¶æ€**: å¼€å‘ä¸­

---

## ğŸ“‹ ç›®å½•

1. [äº§å“æ¦‚è¿°](#äº§å“æ¦‚è¿°)
2. [MVP åŠŸèƒ½èŒƒå›´](#mvp-åŠŸèƒ½èŒƒå›´)
3. [æŠ€æœ¯æ¶æ„](#æŠ€æœ¯æ¶æ„)
4. [æ•°æ®åº“è®¾è®¡](#æ•°æ®åº“è®¾è®¡)
5. [Gemini 2.0 Flash æ”¶æ®è¯†åˆ«](#gemini-20-flash-æ”¶æ®è¯†åˆ«)
6. [API ç«¯ç‚¹è®¾è®¡](#api-ç«¯ç‚¹è®¾è®¡)
7. [å‰ç«¯é¡µé¢ç»“æ„](#å‰ç«¯é¡µé¢ç»“æ„)
8. [å®æ–½æ—¶é—´è¡¨](#å®æ–½æ—¶é—´è¡¨)
9. [æˆæœ¬ä¼°ç®—](#æˆæœ¬ä¼°ç®—)

---

## äº§å“æ¦‚è¿°

### å®šä½
LedgerSnap æ˜¯ä¸€æ¬¾ B2B SaaS äº§å“ï¼Œä¸“æ³¨äºå¸®åŠ©ä¸­å°ä¼ä¸šå’Œè‡ªç”±èŒä¸šè€…é€šè¿‡æ‹ç…§å¿«é€Ÿè®°å½•å’Œç®¡ç†è´¹ç”¨ã€‚

### ç›®æ ‡ç”¨æˆ·
- è‡ªç”±èŒä¸šè€…ï¼ˆè®¾è®¡å¸ˆã€é¡¾é—®ã€å¼€å‘è€…ï¼‰
- å°å‹ä¼ä¸šä¸»ï¼ˆé¤é¥®ã€é›¶å”®ï¼‰
- ç‹¬ç«‹æ‰¿åŒ…å•†
- éœ€è¦è´¹ç”¨æŠ¥é”€çš„ä¼ä¸šå‘˜å·¥

### æ ¸å¿ƒä»·å€¼ä¸»å¼ 
1. **å¿«é€Ÿå½•å…¥**ï¼šæ‹ç…§å³å¯ï¼Œæ— éœ€æ‰‹åŠ¨è¾“å…¥
2. **æ™ºèƒ½è¯†åˆ«**ï¼šAI è‡ªåŠ¨æå–å•†å®¶ã€é‡‘é¢ã€æ—¥æœŸ
3. **è‡ªåŠ¨åˆ†ç±»**ï¼šæ™ºèƒ½åˆ†ç±»è´¹ç”¨ç±»å‹
4. **ç®€å•æŠ¥è¡¨**ï¼šä¸€é”®ç”Ÿæˆæœˆåº¦æŠ¥è¡¨
5. **äº‘ç«¯å­˜å‚¨**ï¼šæ”¶æ®æ°¸ä¸ä¸¢å¤±

---

## MVP åŠŸèƒ½èŒƒå›´

### âœ… åŒ…å«åœ¨ MVP ä¸­

#### 1. è®¤è¯ç³»ç»Ÿ
- âœ… é‚®ç®±æ³¨å†Œ/ç™»å½•ï¼ˆSupabase Authï¼‰
- âœ… å¯†ç é‡ç½®
- âœ… Session ç®¡ç†
- âœ… å—ä¿æŠ¤è·¯ç”±

#### 2. æ”¶æ®ç®¡ç†
- âœ… æ‹ç…§/ä¸Šä¼ æ”¶æ®å›¾ç‰‡
- âœ… AI è‡ªåŠ¨è¯†åˆ«ï¼ˆGemini 2.0 Flashï¼‰
- âœ… æ‰‹åŠ¨ç¼–è¾‘/ç¡®è®¤
- âœ… è´¹ç”¨åˆ—è¡¨ï¼ˆè¡¨æ ¼è§†å›¾ï¼‰
- âœ… æœç´¢å’Œç­›é€‰
- âœ… æŸ¥çœ‹æ”¶æ®è¯¦æƒ…
- âœ… ç¼–è¾‘/åˆ é™¤è´¹ç”¨

#### 3. åˆ†ç±»ç³»ç»Ÿ
- âœ… é¢„è®¾åˆ†ç±»ï¼ˆé£Ÿç‰©ã€äº¤é€šã€åŠå…¬ç”¨å“ç­‰ï¼‰
- âœ… è‡ªå®šä¹‰åˆ†ç±»
- âœ… AI è‡ªåŠ¨å»ºè®®åˆ†ç±»

#### 4. æŠ¥è¡¨åŠŸèƒ½
- âœ… æœˆåº¦è´¹ç”¨æ±‡æ€»
- âœ… æŒ‰åˆ†ç±»ç»Ÿè®¡ï¼ˆé¥¼å›¾ï¼‰
- âœ… è´¹ç”¨è¶‹åŠ¿ï¼ˆæŠ˜çº¿å›¾ï¼‰
- âœ… å¯¼å‡º CSV

#### 5. äº‘ç«¯å­˜å‚¨
- âœ… Cloudflare R2 å›¾ç‰‡å­˜å‚¨
- âœ… æ”¶æ®é¢„è§ˆ
- âœ… åŸå›¾ä¸‹è½½

### âŒ ä¸åŒ…å«åœ¨ MVP ä¸­ï¼ˆPhase 2ï¼‰

- âŒ Google/Apple OAuth ç™»å½•
- âŒ å›¢é˜Ÿåä½œåŠŸèƒ½
- âŒ é¢„ç®—è®¾ç½®å’Œé¢„è­¦
- âŒ é«˜çº§æŠ¥è¡¨ï¼ˆå¹´åº¦ã€å­£åº¦ã€è‡ªå®šä¹‰ï¼‰
- âŒ API é›†æˆ
- âŒ ç§»åŠ¨ç«¯åŸç”Ÿ App
- âŒ å¤šå¸ç§æ”¯æŒ
- âŒ å‘ç¥¨ç”Ÿæˆ
- âŒ ä¼šè®¡è½¯ä»¶é›†æˆï¼ˆQuickBooksã€Xeroï¼‰

---

## æŠ€æœ¯æ¶æ„

### æŠ€æœ¯æ ˆ

```yaml
å‰ç«¯:
  æ¡†æ¶: Next.js 16 (App Router)
  è¯­è¨€: TypeScript
  æ ·å¼: Tailwind CSS
  ç»„ä»¶åº“: shadcn/ui
  å›¾è¡¨: Recharts / Chart.js
  çŠ¶æ€ç®¡ç†: React Context / Zustand

åç«¯:
  æ•°æ®åº“: Supabase (PostgreSQL)
  è®¤è¯: Supabase Auth
  æ–‡ä»¶å­˜å‚¨: Cloudflare R2
  AIè¯†åˆ«: Google Gemini 2.0 Flash API

éƒ¨ç½²:
  å¹³å°: Vercel
  ç¯å¢ƒ: dev / production
  CDN: Cloudflare (R2)
```

### ç³»ç»Ÿæ¶æ„å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Next.js Frontend                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚ Upload   â”‚  â”‚ Receipt  â”‚  â”‚ Reports  â”‚  â”‚ Settingsâ”‚ â”‚
â”‚  â”‚ Page     â”‚  â”‚ List     â”‚  â”‚ Page     â”‚  â”‚ Page    â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   API Routes (Next.js)                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ /api/upload  â”‚  â”‚ /api/analyze â”‚  â”‚ /api/receiptsâ”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚                    â”‚                 â”‚
           â–¼                    â–¼                 â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Cloudflare R2  â”‚  â”‚ Gemini 2.0 Flashâ”‚  â”‚  Supabase    â”‚
â”‚  (Image Storage)â”‚  â”‚  (AI Recognition)â”‚  â”‚  (Database)  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## æ•°æ®åº“è®¾è®¡

### Schema è®¾è®¡ï¼ˆPostgreSQLï¼‰

```sql
-- ========================================
-- ç”¨æˆ·è´¹ç”¨è¡¨
-- ========================================
CREATE TABLE receipts (
  id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),
  user_id UUID REFERENCES auth.users(id) ON DELETE CASCADE NOT NULL,
  
  -- æ”¶æ®ä¿¡æ¯
  merchant_name TEXT,
  receipt_date DATE NOT NULL,
  total_amount DECIMAL(10,2) NOT NULL,
  currency TEXT DEFAULT 'CAD',
  
  -- åˆ†ç±»
  category TEXT NOT NULL,
  subcategory TEXT,
  tags TEXT[], -- æ ‡ç­¾æ•°ç»„
  
  -- AI è¯†åˆ«ç»“æœ
  ocr_raw_text TEXT,
  gemini_response JSONB, -- å­˜å‚¨å®Œæ•´ Gemini å“åº”
  confidence_score DECIMAL(3,2), -- AI è¯†åˆ«ç½®ä¿¡åº¦ (0.00-1.00)
  
  -- å›¾ç‰‡ä¿¡æ¯
  image_url TEXT NOT NULL,
  image_size_bytes INTEGER,
  image_mime_type TEXT,
  
  -- å¤‡æ³¨
  notes TEXT,
  is_reimbursable BOOLEAN DEFAULT false,
  is_tax_deductible BOOLEAN DEFAULT false,
  
  -- å®¡è®¡å­—æ®µ
  created_at TIMESTAMPTZ DEFAULT NOW(),
  updated_at TIMESTAMPTZ DEFAULT NOW(),
  
  -- è½¯åˆ é™¤
  deleted_at TIMESTAMPTZ
);

-- ========================================
-- åˆ†ç±»è¡¨ï¼ˆé¢„è®¾ + è‡ªå®šä¹‰ï¼‰
-- ========================================
CREATE TABLE categories (
  id UUID PRIMARY KEY DEFAULT uuid_generate_v4(),
  user_id UUID REFERENCES auth.users(id) ON DELETE CASCADE,
  name TEXT NOT NULL,
  icon TEXT, -- å›¾æ ‡åç§°ï¼ˆLucide Iconsï¼‰
  color TEXT, -- åå…­è¿›åˆ¶é¢œè‰²
  is_default BOOLEAN DEFAULT false, -- ç³»ç»Ÿé¢„è®¾åˆ†ç±»
  parent_category_id UUID REFERENCES categories(id),
  created_at TIMESTAMPTZ DEFAULT NOW(),
  
  UNIQUE(user_id, name)
);

-- ========================================
-- ç”¨æˆ·è®¾ç½®è¡¨
-- ========================================
CREATE TABLE user_settings (
  user_id UUID PRIMARY KEY REFERENCES auth.users(id) ON DELETE CASCADE,
  
  -- é€šç”¨è®¾ç½®
  default_currency TEXT DEFAULT 'CAD',
  date_format TEXT DEFAULT 'YYYY-MM-DD',
  
  -- é€šçŸ¥è®¾ç½®
  email_notifications BOOLEAN DEFAULT true,
  weekly_summary BOOLEAN DEFAULT true,
  
  -- æ˜¾ç¤ºè®¾ç½®
  theme TEXT DEFAULT 'light', -- light / dark / auto
  items_per_page INTEGER DEFAULT 20,
  
  created_at TIMESTAMPTZ DEFAULT NOW(),
  updated_at TIMESTAMPTZ DEFAULT NOW()
);

-- ========================================
-- ç´¢å¼•
-- ========================================
CREATE INDEX idx_receipts_user_id ON receipts(user_id);
CREATE INDEX idx_receipts_date ON receipts(receipt_date DESC);
CREATE INDEX idx_receipts_category ON receipts(category);
CREATE INDEX idx_receipts_merchant ON receipts(merchant_name);
CREATE INDEX idx_receipts_deleted ON receipts(deleted_at) WHERE deleted_at IS NULL;
CREATE INDEX idx_receipts_tags ON receipts USING GIN(tags);

CREATE INDEX idx_categories_user_id ON categories(user_id);
CREATE INDEX idx_categories_name ON categories(name);

-- ========================================
-- è‡ªåŠ¨æ›´æ–° updated_at
-- ========================================
CREATE OR REPLACE FUNCTION update_updated_at_column()
RETURNS TRIGGER AS $$
BEGIN
  NEW.updated_at = NOW();
  RETURN NEW;
END;
$$ LANGUAGE plpgsql;

CREATE TRIGGER update_receipts_updated_at
  BEFORE UPDATE ON receipts
  FOR EACH ROW
  EXECUTE FUNCTION update_updated_at_column();

CREATE TRIGGER update_user_settings_updated_at
  BEFORE UPDATE ON user_settings
  FOR EACH ROW
  EXECUTE FUNCTION update_updated_at_column();

-- ========================================
-- Row Level Security (RLS)
-- ========================================
ALTER TABLE receipts ENABLE ROW LEVEL SECURITY;
ALTER TABLE categories ENABLE ROW LEVEL SECURITY;
ALTER TABLE user_settings ENABLE ROW LEVEL SECURITY;

-- Receipts ç­–ç•¥
CREATE POLICY "Users can view their own receipts"
  ON receipts FOR SELECT
  USING (auth.uid() = user_id AND deleted_at IS NULL);

CREATE POLICY "Users can insert their own receipts"
  ON receipts FOR INSERT
  WITH CHECK (auth.uid() = user_id);

CREATE POLICY "Users can update their own receipts"
  ON receipts FOR UPDATE
  USING (auth.uid() = user_id);

CREATE POLICY "Users can delete their own receipts"
  ON receipts FOR DELETE
  USING (auth.uid() = user_id);

-- Categories ç­–ç•¥
CREATE POLICY "Users can view their own categories and defaults"
  ON categories FOR SELECT
  USING (auth.uid() = user_id OR is_default = true);

CREATE POLICY "Users can insert their own categories"
  ON categories FOR INSERT
  WITH CHECK (auth.uid() = user_id AND is_default = false);

CREATE POLICY "Users can update their own categories"
  ON categories FOR UPDATE
  USING (auth.uid() = user_id AND is_default = false);

CREATE POLICY "Users can delete their own categories"
  ON categories FOR DELETE
  USING (auth.uid() = user_id AND is_default = false);

-- User Settings ç­–ç•¥
CREATE POLICY "Users can view their own settings"
  ON user_settings FOR SELECT
  USING (auth.uid() = user_id);

CREATE POLICY "Users can insert their own settings"
  ON user_settings FOR INSERT
  WITH CHECK (auth.uid() = user_id);

CREATE POLICY "Users can update their own settings"
  ON user_settings FOR UPDATE
  USING (auth.uid() = user_id);

-- ========================================
-- è§†å›¾ï¼šæœˆåº¦æ±‡æ€»
-- ========================================
CREATE OR REPLACE VIEW monthly_summary AS
SELECT
  user_id,
  DATE_TRUNC('month', receipt_date) AS month,
  category,
  COUNT(*) AS receipt_count,
  SUM(total_amount) AS total_spent,
  AVG(total_amount) AS avg_amount
FROM receipts
WHERE deleted_at IS NULL
GROUP BY user_id, month, category;

-- ========================================
-- æ’å…¥é»˜è®¤åˆ†ç±»
-- ========================================
INSERT INTO categories (name, icon, color, is_default) VALUES
  ('Food & Dining', 'utensils', '#EF4444', true),
  ('Transportation', 'car', '#3B82F6', true),
  ('Office Supplies', 'briefcase', '#8B5CF6', true),
  ('Utilities', 'zap', '#F59E0B', true),
  ('Entertainment', 'film', '#EC4899', true),
  ('Healthcare', 'heart', '#10B981', true),
  ('Travel', 'plane', '#06B6D4', true),
  ('Shopping', 'shopping-bag', '#6366F1', true),
  ('Professional Services', 'users', '#14B8A6', true),
  ('Other', 'more-horizontal', '#6B7280', true);

-- ========================================
-- åˆ†æå‡½æ•°ï¼šæŒ‰ç±»åˆ«ç»Ÿè®¡
-- ========================================
CREATE OR REPLACE FUNCTION get_category_breakdown(
  p_user_id UUID,
  p_start_date DATE,
  p_end_date DATE
)
RETURNS TABLE (
  category TEXT,
  count BIGINT,
  total_amount NUMERIC,
  percentage NUMERIC
) AS $$
BEGIN
  RETURN QUERY
  SELECT
    r.category,
    COUNT(*)::BIGINT AS count,
    SUM(r.total_amount) AS total_amount,
    ROUND(
      (SUM(r.total_amount) / NULLIF(
        (SELECT SUM(total_amount) FROM receipts 
         WHERE user_id = p_user_id 
         AND receipt_date BETWEEN p_start_date AND p_end_date
         AND deleted_at IS NULL), 
        0
      ) * 100), 
      2
    ) AS percentage
  FROM receipts r
  WHERE r.user_id = p_user_id
    AND r.receipt_date BETWEEN p_start_date AND p_end_date
    AND r.deleted_at IS NULL
  GROUP BY r.category
  ORDER BY total_amount DESC;
END;
$$ LANGUAGE plpgsql;
```

---

## Gemini 2.0 Flash æ”¶æ®è¯†åˆ«

### API é…ç½®

```typescript
// lib/gemini.ts
import { GoogleGenerativeAI } from '@google/generative-ai';

const genAI = new GoogleGenerativeAI(process.env.GEMINI_API_KEY!);

// ä½¿ç”¨ Gemini 2.0 Flash æ¨¡å‹
const model = genAI.getGenerativeModel({ 
  model: "gemini-2.0-flash-exp" // æˆ– "gemini-2.0-flash-001"
});
```

### æç¤ºè¯è®¾è®¡ï¼ˆPrompt Engineeringï¼‰

```typescript
const RECEIPT_ANALYSIS_PROMPT = `
You are a receipt analysis AI. Analyze this receipt image and extract the following information in JSON format:

{
  "merchant_name": "Store or business name",
  "receipt_date": "YYYY-MM-DD format",
  "total_amount": "Numeric value only (e.g., 45.99)",
  "currency": "Currency code (e.g., CAD, USD)",
  "items": [
    {
      "description": "Item description",
      "quantity": 1,
      "price": 10.00
    }
  ],
  "category": "Suggested category from: Food & Dining, Transportation, Office Supplies, Utilities, Entertainment, Healthcare, Travel, Shopping, Professional Services, Other",
  "confidence": "0.0 to 1.0",
  "raw_text": "All visible text from the receipt"
}

Important guidelines:
1. Extract dates carefully (check DD/MM vs MM/DD based on context)
2. Total amount should be the final amount paid (after tax)
3. Currency should default to CAD if not specified
4. Category should be your best guess based on merchant name and items
5. Confidence should reflect how certain you are about the extraction
6. If any field is unclear, use null
7. Return ONLY valid JSON, no additional text

Receipt Image:
`;
```

### å®Œæ•´è¯†åˆ«æµç¨‹

```typescript
// lib/receipt-analyzer.ts
import { GoogleGenerativeAI } from '@google/generative-ai';

interface ReceiptData {
  merchant_name: string | null;
  receipt_date: string | null;
  total_amount: number | null;
  currency: string;
  items: Array<{
    description: string;
    quantity: number;
    price: number;
  }>;
  category: string;
  confidence: number;
  raw_text: string;
}

export async function analyzeReceipt(
  imageBuffer: Buffer,
  mimeType: string
): Promise<ReceiptData> {
  try {
    const genAI = new GoogleGenerativeAI(process.env.GEMINI_API_KEY!);
    const model = genAI.getGenerativeModel({ 
      model: "gemini-2.0-flash-exp" 
    });

    // å°†å›¾ç‰‡è½¬æ¢ä¸º base64
    const imageBase64 = imageBuffer.toString('base64');

    const result = await model.generateContent([
      RECEIPT_ANALYSIS_PROMPT,
      {
        inlineData: {
          mimeType: mimeType,
          data: imageBase64,
        },
      },
    ]);

    const response = await result.response;
    const text = response.text();
    
    // æ¸…ç† Gemini å“åº”ï¼ˆå»é™¤ Markdown ä»£ç å—ï¼‰
    const cleanedText = text
      .replace(/```json\n?/g, '')
      .replace(/```\n?/g, '')
      .trim();

    const receiptData: ReceiptData = JSON.parse(cleanedText);

    // éªŒè¯å’Œæ ‡å‡†åŒ–æ•°æ®
    return {
      merchant_name: receiptData.merchant_name || 'Unknown Merchant',
      receipt_date: receiptData.receipt_date || new Date().toISOString().split('T')[0],
      total_amount: receiptData.total_amount || 0,
      currency: receiptData.currency || 'CAD',
      items: receiptData.items || [],
      category: receiptData.category || 'Other',
      confidence: receiptData.confidence || 0.5,
      raw_text: receiptData.raw_text || '',
    };
  } catch (error) {
    console.error('Gemini analysis error:', error);
    throw new Error('Failed to analyze receipt with Gemini');
  }
}
```

### é”™è¯¯å¤„ç†å’Œé‡è¯•æœºåˆ¶

```typescript
// lib/receipt-analyzer.ts (ç»­)
import { retry } from '@/lib/utils/retry';

export async function analyzeReceiptWithRetry(
  imageBuffer: Buffer,
  mimeType: string,
  maxRetries = 3
): Promise<ReceiptData> {
  return retry(
    () => analyzeReceipt(imageBuffer, mimeType),
    {
      maxRetries,
      retryDelay: 1000,
      shouldRetry: (error) => {
        // åªé‡è¯•ç½‘ç»œé”™è¯¯å’Œé€Ÿç‡é™åˆ¶
        return error.message.includes('network') || 
               error.message.includes('rate limit');
      }
    }
  );
}
```

### æˆæœ¬ä¼˜åŒ–ç­–ç•¥

```yaml
Gemini 2.0 Flash å®šä»·ï¼ˆæˆªè‡³ 2024ï¼‰:
  è¾“å…¥ï¼ˆæ¯ç™¾ä¸‡ tokensï¼‰: $0.075
  è¾“å‡ºï¼ˆæ¯ç™¾ä¸‡ tokensï¼‰: $0.30
  
ä¼°ç®—:
  æ¯å¼ æ”¶æ®å›¾ç‰‡: ~1,000 tokens (è¾“å…¥) + 500 tokens (è¾“å‡º)
  å•æ¬¡è¯†åˆ«æˆæœ¬: ~$0.0002 (çº¦ 0.02 åˆ†é’±)
  
æœˆåº¦æˆæœ¬ä¼°ç®—:
  100 å¼ æ”¶æ®/æœˆ: $0.02
  1,000 å¼ æ”¶æ®/æœˆ: $0.20
  10,000 å¼ æ”¶æ®/æœˆ: $2.00
  
ä¼˜åŒ–å»ºè®®:
  1. å‹ç¼©å›¾ç‰‡åˆ° 1024x1024 ä»¥ä¸‹
  2. ä½¿ç”¨ JPEG æ ¼å¼ï¼ˆæ¯” PNG å°ï¼‰
  3. ç¼“å­˜å·²è¯†åˆ«çš„æ”¶æ®
  4. æ‰¹é‡å¤„ç†ï¼ˆå¦‚æœé€‚ç”¨ï¼‰
```

---

## API ç«¯ç‚¹è®¾è®¡

### 1. ä¸Šä¼ å¹¶è¯†åˆ«æ”¶æ®

```typescript
// app/api/receipts/upload/route.ts
import { NextRequest, NextResponse } from 'next/server';
import { createClient } from '@/lib/supabase/server';
import { uploadToR2 } from '@/lib/cloudflare-r2';
import { analyzeReceiptWithRetry } from '@/lib/receipt-analyzer';

export async function POST(request: NextRequest) {
  try {
    const supabase = createClient();
    
    // éªŒè¯ç”¨æˆ·è®¤è¯
    const { data: { user }, error: authError } = await supabase.auth.getUser();
    if (authError || !user) {
      return NextResponse.json(
        { error: 'Unauthorized' },
        { status: 401 }
      );
    }

    // è§£æä¸Šä¼ çš„æ–‡ä»¶
    const formData = await request.formData();
    const file = formData.get('file') as File;
    
    if (!file) {
      return NextResponse.json(
        { error: 'No file uploaded' },
        { status: 400 }
      );
    }

    // éªŒè¯æ–‡ä»¶ç±»å‹
    const validTypes = ['image/jpeg', 'image/png', 'image/webp'];
    if (!validTypes.includes(file.type)) {
      return NextResponse.json(
        { error: 'Invalid file type. Only JPEG, PNG, and WebP are supported.' },
        { status: 400 }
      );
    }

    // éªŒè¯æ–‡ä»¶å¤§å°ï¼ˆæœ€å¤§ 10MBï¼‰
    const maxSize = 10 * 1024 * 1024;
    if (file.size > maxSize) {
      return NextResponse.json(
        { error: 'File too large. Maximum size is 10MB.' },
        { status: 400 }
      );
    }

    // è½¬æ¢ä¸º Buffer
    const buffer = Buffer.from(await file.arrayBuffer());

    // ä¸Šä¼ åˆ° Cloudflare R2
    const fileName = `${user.id}/${Date.now()}-${file.name}`;
    const imageUrl = await uploadToR2(buffer, fileName, file.type);

    // ä½¿ç”¨ Gemini åˆ†ææ”¶æ®
    const analysisResult = await analyzeReceiptWithRetry(buffer, file.type);

    // ä¿å­˜åˆ°æ•°æ®åº“
    const { data: receipt, error: dbError } = await supabase
      .from('receipts')
      .insert({
        user_id: user.id,
        merchant_name: analysisResult.merchant_name,
        receipt_date: analysisResult.receipt_date,
        total_amount: analysisResult.total_amount,
        currency: analysisResult.currency,
        category: analysisResult.category,
        ocr_raw_text: analysisResult.raw_text,
        gemini_response: analysisResult,
        confidence_score: analysisResult.confidence,
        image_url: imageUrl,
        image_size_bytes: file.size,
        image_mime_type: file.type,
      })
      .select()
      .single();

    if (dbError) {
      console.error('Database error:', dbError);
      return NextResponse.json(
        { error: 'Failed to save receipt' },
        { status: 500 }
      );
    }

    return NextResponse.json({
      success: true,
      receipt,
      analysis: analysisResult,
    });

  } catch (error) {
    console.error('Upload error:', error);
    return NextResponse.json(
      { error: 'Failed to process receipt' },
      { status: 500 }
    );
  }
}
```

### 2. è·å–æ”¶æ®åˆ—è¡¨

```typescript
// app/api/receipts/route.ts
import { NextRequest, NextResponse } from 'next/server';
import { createClient } from '@/lib/supabase/server';

export async function GET(request: NextRequest) {
  try {
    const supabase = createClient();
    
    // éªŒè¯ç”¨æˆ·è®¤è¯
    const { data: { user }, error: authError } = await supabase.auth.getUser();
    if (authError || !user) {
      return NextResponse.json({ error: 'Unauthorized' }, { status: 401 });
    }

    // è§£ææŸ¥è¯¢å‚æ•°
    const { searchParams } = new URL(request.url);
    const page = parseInt(searchParams.get('page') || '1');
    const limit = parseInt(searchParams.get('limit') || '20');
    const category = searchParams.get('category');
    const startDate = searchParams.get('start_date');
    const endDate = searchParams.get('end_date');
    const search = searchParams.get('search');

    // æ„å»ºæŸ¥è¯¢
    let query = supabase
      .from('receipts')
      .select('*', { count: 'exact' })
      .eq('user_id', user.id)
      .is('deleted_at', null)
      .order('receipt_date', { ascending: false })
      .range((page - 1) * limit, page * limit - 1);

    // åº”ç”¨è¿‡æ»¤å™¨
    if (category) {
      query = query.eq('category', category);
    }

    if (startDate) {
      query = query.gte('receipt_date', startDate);
    }

    if (endDate) {
      query = query.lte('receipt_date', endDate);
    }

    if (search) {
      query = query.or(
        `merchant_name.ilike.%${search}%,notes.ilike.%${search}%`
      );
    }

    const { data: receipts, error: dbError, count } = await query;

    if (dbError) {
      console.error('Database error:', dbError);
      return NextResponse.json(
        { error: 'Failed to fetch receipts' },
        { status: 500 }
      );
    }

    return NextResponse.json({
      receipts,
      pagination: {
        page,
        limit,
        total: count,
        totalPages: Math.ceil((count || 0) / limit),
      },
    });

  } catch (error) {
    console.error('Fetch error:', error);
    return NextResponse.json(
      { error: 'Failed to fetch receipts' },
      { status: 500 }
    );
  }
}
```

### 3. æ›´æ–°æ”¶æ®

```typescript
// app/api/receipts/[id]/route.ts
import { NextRequest, NextResponse } from 'next/server';
import { createClient } from '@/lib/supabase/server';

export async function PATCH(
  request: NextRequest,
  { params }: { params: { id: string } }
) {
  try {
    const supabase = createClient();
    
    const { data: { user }, error: authError } = await supabase.auth.getUser();
    if (authError || !user) {
      return NextResponse.json({ error: 'Unauthorized' }, { status: 401 });
    }

    const updates = await request.json();

    // éªŒè¯å…è®¸æ›´æ–°çš„å­—æ®µ
    const allowedFields = [
      'merchant_name',
      'receipt_date',
      'total_amount',
      'category',
      'subcategory',
      'notes',
      'tags',
      'is_reimbursable',
      'is_tax_deductible',
    ];

    const filteredUpdates = Object.keys(updates)
      .filter(key => allowedFields.includes(key))
      .reduce((obj, key) => {
        obj[key] = updates[key];
        return obj;
      }, {} as any);

    const { data: receipt, error: dbError } = await supabase
      .from('receipts')
      .update(filteredUpdates)
      .eq('id', params.id)
      .eq('user_id', user.id)
      .select()
      .single();

    if (dbError) {
      console.error('Database error:', dbError);
      return NextResponse.json(
        { error: 'Failed to update receipt' },
        { status: 500 }
      );
    }

    if (!receipt) {
      return NextResponse.json(
        { error: 'Receipt not found' },
        { status: 404 }
      );
    }

    return NextResponse.json({ receipt });

  } catch (error) {
    console.error('Update error:', error);
    return NextResponse.json(
      { error: 'Failed to update receipt' },
      { status: 500 }
    );
  }
}

export async function DELETE(
  request: NextRequest,
  { params }: { params: { id: string } }
) {
  try {
    const supabase = createClient();
    
    const { data: { user }, error: authError } = await supabase.auth.getUser();
    if (authError || !user) {
      return NextResponse.json({ error: 'Unauthorized' }, { status: 401 });
    }

    // è½¯åˆ é™¤
    const { error: dbError } = await supabase
      .from('receipts')
      .update({ deleted_at: new Date().toISOString() })
      .eq('id', params.id)
      .eq('user_id', user.id);

    if (dbError) {
      console.error('Database error:', dbError);
      return NextResponse.json(
        { error: 'Failed to delete receipt' },
        { status: 500 }
      );
    }

    return NextResponse.json({ success: true });

  } catch (error) {
    console.error('Delete error:', error);
    return NextResponse.json(
      { error: 'Failed to delete receipt' },
      { status: 500 }
    );
  }
}
```

### 4. æŠ¥è¡¨ API

```typescript
// app/api/reports/summary/route.ts
import { NextRequest, NextResponse } from 'next/server';
import { createClient } from '@/lib/supabase/server';

export async function GET(request: NextRequest) {
  try {
    const supabase = createClient();
    
    const { data: { user }, error: authError } = await supabase.auth.getUser();
    if (authError || !user) {
      return NextResponse.json({ error: 'Unauthorized' }, { status: 401 });
    }

    const { searchParams } = new URL(request.url);
    const month = searchParams.get('month'); // YYYY-MM format

    if (!month) {
      return NextResponse.json(
        { error: 'Month parameter is required' },
        { status: 400 }
      );
    }

    const startDate = `${month}-01`;
    const endDate = new Date(
      new Date(startDate).getFullYear(),
      new Date(startDate).getMonth() + 1,
      0
    ).toISOString().split('T')[0];

    // è·å–åˆ†ç±»ç»Ÿè®¡
    const { data: categoryBreakdown, error: categoryError } = await supabase
      .rpc('get_category_breakdown', {
        p_user_id: user.id,
        p_start_date: startDate,
        p_end_date: endDate,
      });

    if (categoryError) {
      console.error('Category breakdown error:', categoryError);
      return NextResponse.json(
        { error: 'Failed to generate report' },
        { status: 500 }
      );
    }

    // è·å–æ€»è®¡
    const { data: receipts, error: receiptsError } = await supabase
      .from('receipts')
      .select('total_amount')
      .eq('user_id', user.id)
      .gte('receipt_date', startDate)
      .lte('receipt_date', endDate)
      .is('deleted_at', null);

    if (receiptsError) {
      console.error('Receipts error:', receiptsError);
      return NextResponse.json(
        { error: 'Failed to calculate totals' },
        { status: 500 }
      );
    }

    const totalSpent = receipts.reduce(
      (sum, r) => sum + parseFloat(r.total_amount),
      0
    );

    return NextResponse.json({
      month,
      totalSpent,
      receiptCount: receipts.length,
      categoryBreakdown,
    });

  } catch (error) {
    console.error('Report error:', error);
    return NextResponse.json(
      { error: 'Failed to generate report' },
      { status: 500 }
    );
  }
}
```

---

## å‰ç«¯é¡µé¢ç»“æ„

### é¡µé¢è·¯ç”±ç»“æ„

```
app/
â”œâ”€â”€ (auth)/
â”‚   â”œâ”€â”€ login/
â”‚   â”‚   â””â”€â”€ page.tsx
â”‚   â”œâ”€â”€ register/
â”‚   â”‚   â””â”€â”€ page.tsx
â”‚   â””â”€â”€ reset-password/
â”‚       â””â”€â”€ page.tsx
â”œâ”€â”€ (dashboard)/
â”‚   â”œâ”€â”€ layout.tsx         # Dashboard å¸ƒå±€ï¼ˆä¾§è¾¹æ ï¼‰
â”‚   â”œâ”€â”€ page.tsx           # ä¸»é¡µï¼ˆé‡å®šå‘åˆ° /receiptsï¼‰
â”‚   â”œâ”€â”€ receipts/
â”‚   â”‚   â”œâ”€â”€ page.tsx       # æ”¶æ®åˆ—è¡¨
â”‚   â”‚   â”œâ”€â”€ upload/
â”‚   â”‚   â”‚   â””â”€â”€ page.tsx   # ä¸Šä¼ æ”¶æ®
â”‚   â”‚   â””â”€â”€ [id]/
â”‚   â”‚       â””â”€â”€ page.tsx   # æ”¶æ®è¯¦æƒ…
â”‚   â”œâ”€â”€ reports/
â”‚   â”‚   â””â”€â”€ page.tsx       # æŠ¥è¡¨é¡µé¢
â”‚   â””â”€â”€ settings/
â”‚       â””â”€â”€ page.tsx       # è®¾ç½®é¡µé¢
â””â”€â”€ api/                   # API è·¯ç”±ï¼ˆè§ä¸Šæ–‡ï¼‰
```

### 1. ä¸Šä¼ é¡µé¢

```typescript
// app/(dashboard)/receipts/upload/page.tsx
'use client';

import { useState } from 'react';
import { useRouter } from 'next/navigation';
import { Upload, Loader2, CheckCircle, XCircle } from 'lucide-react';
import { Button } from '@/components/ui/button';
import { Card } from '@/components/ui/card';

export default function UploadReceiptPage() {
  const router = useRouter();
  const [file, setFile] = useState<File | null>(null);
  const [preview, setPreview] = useState<string | null>(null);
  const [uploading, setUploading] = useState(false);
  const [result, setResult] = useState<any>(null);
  const [error, setError] = useState<string | null>(null);

  const handleFileChange = (e: React.ChangeEvent<HTMLInputElement>) => {
    const selectedFile = e.target.files?.[0];
    if (selectedFile) {
      setFile(selectedFile);
      setPreview(URL.createObjectURL(selectedFile));
      setError(null);
    }
  };

  const handleUpload = async () => {
    if (!file) return;

    setUploading(true);
    setError(null);

    try {
      const formData = new FormData();
      formData.append('file', file);

      const response = await fetch('/api/receipts/upload', {
        method: 'POST',
        body: formData,
      });

      if (!response.ok) {
        throw new Error('Upload failed');
      }

      const data = await response.json();
      setResult(data);

      // 3ç§’åè·³è½¬åˆ°æ”¶æ®è¯¦æƒ…é¡µ
      setTimeout(() => {
        router.push(`/receipts/${data.receipt.id}`);
      }, 3000);

    } catch (err) {
      setError('Failed to upload receipt. Please try again.');
      console.error(err);
    } finally {
      setUploading(false);
    }
  };

  return (
    <div className="max-w-2xl mx-auto p-6">
      <h1 className="text-3xl font-bold mb-6">Upload Receipt</h1>

      <Card className="p-8">
        {!preview ? (
          <label className="flex flex-col items-center justify-center h-64 border-2 border-dashed border-gray-300 rounded-lg cursor-pointer hover:border-blue-500 transition">
            <Upload className="w-12 h-12 text-gray-400 mb-4" />
            <span className="text-sm text-gray-600">
              Click to upload or drag and drop
            </span>
            <span className="text-xs text-gray-500 mt-2">
              PNG, JPG or WEBP (max. 10MB)
            </span>
            <input
              type="file"
              accept="image/jpeg,image/png,image/webp"
              onChange={handleFileChange}
              className="hidden"
            />
          </label>
        ) : (
          <div className="space-y-4">
            <img
              src={preview}
              alt="Receipt preview"
              className="w-full rounded-lg"
            />

            {!result ? (
              <div className="flex gap-4">
                <Button
                  onClick={handleUpload}
                  disabled={uploading}
                  className="flex-1"
                >
                  {uploading ? (
                    <>
                      <Loader2 className="w-4 h-4 mr-2 animate-spin" />
                      Analyzing...
                    </>
                  ) : (
                    'Upload & Analyze'
                  )}
                </Button>
                <Button
                  variant="outline"
                  onClick={() => {
                    setFile(null);
                    setPreview(null);
                  }}
                >
                  Cancel
                </Button>
              </div>
            ) : (
              <div className="bg-green-50 border border-green-200 rounded-lg p-4">
                <div className="flex items-center gap-2 mb-2">
                  <CheckCircle className="w-5 h-5 text-green-600" />
                  <span className="font-semibold text-green-900">
                    Receipt Analyzed Successfully!
                  </span>
                </div>
                <div className="text-sm text-green-800 space-y-1">
                  <p><strong>Merchant:</strong> {result.analysis.merchant_name}</p>
                  <p><strong>Amount:</strong> ${result.analysis.total_amount}</p>
                  <p><strong>Date:</strong> {result.analysis.receipt_date}</p>
                  <p><strong>Category:</strong> {result.analysis.category}</p>
                </div>
                <p className="text-xs text-green-700 mt-2">
                  Redirecting to receipt details...
                </p>
              </div>
            )}

            {error && (
              <div className="bg-red-50 border border-red-200 rounded-lg p-4">
                <div className="flex items-center gap-2">
                  <XCircle className="w-5 h-5 text-red-600" />
                  <span className="text-sm text-red-900">{error}</span>
                </div>
              </div>
            )}
          </div>
        )}
      </Card>
    </div>
  );
}
```

### 2. æ”¶æ®åˆ—è¡¨é¡µé¢

```typescript
// app/(dashboard)/receipts/page.tsx
'use client';

import { useEffect, useState } from 'react';
import { useRouter } from 'next/navigation';
import { Plus, Search, Filter } from 'lucide-react';
import { Button } from '@/components/ui/button';
import { Input } from '@/components/ui/input';
import { ReceiptCard } from '@/components/receipts/receipt-card';

export default function ReceiptsPage() {
  const router = useRouter();
  const [receipts, setReceipts] = useState([]);
  const [loading, setLoading] = useState(true);
  const [search, setSearch] = useState('');

  useEffect(() => {
    fetchReceipts();
  }, []);

  const fetchReceipts = async () => {
    try {
      const response = await fetch('/api/receipts');
      const data = await response.json();
      setReceipts(data.receipts);
    } catch (error) {
      console.error('Failed to fetch receipts:', error);
    } finally {
      setLoading(false);
    }
  };

  return (
    <div className="p-6">
      <div className="flex justify-between items-center mb-6">
        <h1 className="text-3xl font-bold">Receipts</h1>
        <Button onClick={() => router.push('/receipts/upload')}>
          <Plus className="w-4 h-4 mr-2" />
          Upload Receipt
        </Button>
      </div>

      <div className="flex gap-4 mb-6">
        <div className="relative flex-1">
          <Search className="absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400" />
          <Input
            placeholder="Search receipts..."
            value={search}
            onChange={(e) => setSearch(e.target.value)}
            className="pl-10"
          />
        </div>
        <Button variant="outline">
          <Filter className="w-4 h-4 mr-2" />
          Filter
        </Button>
      </div>

      {loading ? (
        <div className="text-center py-12">Loading...</div>
      ) : receipts.length === 0 ? (
        <div className="text-center py-12">
          <p className="text-gray-600 mb-4">No receipts yet</p>
          <Button onClick={() => router.push('/receipts/upload')}>
            Upload Your First Receipt
          </Button>
        </div>
      ) : (
        <div className="grid gap-4 md:grid-cols-2 lg:grid-cols-3">
          {receipts.map((receipt: any) => (
            <ReceiptCard
              key={receipt.id}
              receipt={receipt}
              onClick={() => router.push(`/receipts/${receipt.id}`)}
            />
          ))}
        </div>
      )}
    </div>
  );
}
```

---

## å®æ–½æ—¶é—´è¡¨

### Week 1: åŸºç¡€è®¾æ–½ + è®¤è¯ï¼ˆJan 27 - Feb 2ï¼‰

```yaml
Day 1-2: æ•°æ®åº“è®¾ç½®
  â˜ åœ¨ Supabase ä¸­è¿è¡Œè¿ç§»è„šæœ¬
  â˜ éªŒè¯è¡¨ç»“æ„å’Œ RLS ç­–ç•¥
  â˜ æ’å…¥é»˜è®¤åˆ†ç±»æ•°æ®
  â˜ æµ‹è¯•æ•°æ®åº“è¿æ¥

Day 3-4: è®¤è¯ç³»ç»Ÿ
  â˜ å®Œå–„ç™»å½•/æ³¨å†Œé¡µé¢
  â˜ å®ç°å¯†ç é‡ç½®åŠŸèƒ½
  â˜ é…ç½® Session ç®¡ç†
  â˜ åˆ›å»ºè®¤è¯ä¸­é—´ä»¶
  â˜ ä¿æŠ¤ Dashboard è·¯ç”±

Day 5-7: åŸºç¡€ UI æ¡†æ¶
  â˜ å®‰è£… shadcn/ui ç»„ä»¶
  â˜ åˆ›å»º Dashboard å¸ƒå±€
  â˜ è®¾è®¡ä¾§è¾¹æ å¯¼èˆª
  â˜ åˆ›å»ºç©ºç™½é¡µé¢æ¡†æ¶
```

### Week 2: Gemini é›†æˆ + ä¸Šä¼ åŠŸèƒ½ï¼ˆFeb 3 - Feb 9ï¼‰

```yaml
Day 1-2: Cloudflare R2 é…ç½®
  â˜ åˆ›å»º R2 å­˜å‚¨æ¡¶
  â˜ é…ç½® API å¯†é’¥
  â˜ å®ç°ä¸Šä¼ å·¥å…·å‡½æ•°
  â˜ æµ‹è¯•å›¾ç‰‡ä¸Šä¼ 

Day 3-5: Gemini è¯†åˆ«
  â˜ å®‰è£… Gemini SDK
  â˜ è®¾è®¡æç¤ºè¯
  â˜ å®ç°è¯†åˆ«å‡½æ•°
  â˜ æ·»åŠ é”™è¯¯å¤„ç†å’Œé‡è¯•
  â˜ æµ‹è¯•å„ç§æ”¶æ®æ ¼å¼

Day 6-7: ä¸Šä¼ é¡µé¢
  â˜ åˆ›å»ºæ–‡ä»¶ä¸Šä¼  UI
  â˜ å®ç°æ‹–æ‹½ä¸Šä¼ 
  â˜ æ˜¾ç¤ºé¢„è§ˆ
  â˜ è°ƒç”¨è¯†åˆ« API
  â˜ æ˜¾ç¤ºè¯†åˆ«ç»“æœ
```

### Week 3: æ”¶æ®ç®¡ç†ï¼ˆFeb 10 - Feb 16ï¼‰

```yaml
Day 1-3: æ”¶æ®åˆ—è¡¨
  â˜ åˆ›å»ºæ”¶æ®åˆ—è¡¨ API
  â˜ å®ç°æœç´¢åŠŸèƒ½
  â˜ æ·»åŠ è¿‡æ»¤é€‰é¡¹
  â˜ è®¾è®¡æ”¶æ®å¡ç‰‡ç»„ä»¶
  â˜ å®ç°åˆ†é¡µ

Day 4-5: æ”¶æ®è¯¦æƒ…
  â˜ åˆ›å»ºè¯¦æƒ…é¡µé¢
  â˜ æ˜¾ç¤ºæ”¶æ®ä¿¡æ¯
  â˜ æŸ¥çœ‹åŸå›¾
  â˜ ç¼–è¾‘åŠŸèƒ½
  â˜ åˆ é™¤åŠŸèƒ½

Day 6-7: åˆ†ç±»ç®¡ç†
  â˜ æ˜¾ç¤ºé¢„è®¾åˆ†ç±»
  â˜ åˆ›å»ºè‡ªå®šä¹‰åˆ†ç±»
  â˜ ç¼–è¾‘åˆ†ç±»
  â˜ åˆ†ç±»å›¾æ ‡å’Œé¢œè‰²é€‰æ‹©
```

### Week 4: æŠ¥è¡¨åŠŸèƒ½ï¼ˆFeb 17 - Feb 23ï¼‰

```yaml
Day 1-3: ç»Ÿè®¡ API
  â˜ å®ç°æœˆåº¦æ±‡æ€»
  â˜ æŒ‰åˆ†ç±»ç»Ÿè®¡
  â˜ è´¹ç”¨è¶‹åŠ¿åˆ†æ
  â˜ å¯¼å‡º CSV åŠŸèƒ½

Day 4-7: æŠ¥è¡¨ UI
  â˜ å®‰è£…å›¾è¡¨åº“ï¼ˆRechartsï¼‰
  â˜ åˆ›å»ºé¥¼å›¾ï¼ˆåˆ†ç±»å æ¯”ï¼‰
  â˜ åˆ›å»ºæŠ˜çº¿å›¾ï¼ˆè´¹ç”¨è¶‹åŠ¿ï¼‰
  â˜ æ˜¾ç¤ºç»Ÿè®¡æ•°æ®
  â˜ å®ç°å¯¼å‡ºåŠŸèƒ½
  â˜ æœˆä»½é€‰æ‹©å™¨
```

### Week 5: æµ‹è¯•å’Œä¼˜åŒ–ï¼ˆFeb 24 - Mar 2ï¼‰

```yaml
Day 1-3: åŠŸèƒ½æµ‹è¯•
  â˜ ç«¯åˆ°ç«¯æµ‹è¯•
  â˜ Bug ä¿®å¤
  â˜ è¾¹ç•Œæƒ…å†µå¤„ç†
  â˜ æ€§èƒ½ä¼˜åŒ–

Day 4-5: UI/UX ä¼˜åŒ–
  â˜ å“åº”å¼è®¾è®¡æ£€æŸ¥
  â˜ åŠ è½½çŠ¶æ€ä¼˜åŒ–
  â˜ é”™è¯¯æç¤ºä¼˜åŒ–
  â˜ ç”¨æˆ·ä½“éªŒæ”¹è¿›

Day 6-7: å‡†å¤‡ä¸Šçº¿
  â˜ æ–‡æ¡£ç¼–å†™
  â˜ éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒ
  â˜ ç›‘æ§è®¾ç½®
  â˜ Beta æµ‹è¯•å‡†å¤‡
```

---

## æˆæœ¬ä¼°ç®—

### å¼€å‘æˆæœ¬ï¼ˆæ—¶é—´æŠ•å…¥ï¼‰

```yaml
æ€»å¼€å‘æ—¶é—´: ~5 å‘¨ï¼ˆçº¦ 200 å°æ—¶ï¼‰

Week 1 (åŸºç¡€è®¾æ–½): 40 å°æ—¶
Week 2 (Gemini é›†æˆ): 40 å°æ—¶
Week 3 (æ”¶æ®ç®¡ç†): 40 å°æ—¶
Week 4 (æŠ¥è¡¨åŠŸèƒ½): 40 å°æ—¶
Week 5 (æµ‹è¯•ä¼˜åŒ–): 40 å°æ—¶
```

### è¿è¥æˆæœ¬ï¼ˆæœˆåº¦ï¼‰

```yaml
åŸºç¡€è®¾æ–½æˆæœ¬:
  Vercel Pro: $20/æœˆï¼ˆå¯é€‰ï¼ŒHobby å…è´¹ï¼‰
  Supabase Pro: $25/æœˆï¼ˆå‰æœŸå¯ç”¨å…è´¹ç‰ˆï¼‰
  Cloudflare R2: ~$1/æœˆï¼ˆ10GB å­˜å‚¨ + æµé‡ï¼‰
  
AI è¯†åˆ«æˆæœ¬ï¼ˆGemini 2.0 Flashï¼‰:
  100 å¼ æ”¶æ®/æœˆ: $0.02
  1,000 å¼ æ”¶æ®/æœˆ: $0.20
  10,000 å¼ æ”¶æ®/æœˆ: $2.00
  
æ€»è®¡ï¼ˆä¿å®ˆä¼°è®¡ï¼‰:
  å‰æœŸï¼ˆå…è´¹å±‚ï¼‰: ~$1-2/æœˆ
  å¢é•¿æœŸï¼ˆä»˜è´¹å±‚ï¼‰: ~$50-100/æœˆ
```

### æ”¶å…¥é¢„æµ‹ï¼ˆå‡è®¾ï¼‰

```yaml
å®šä»·ç­–ç•¥:
  Free Tier:
    - æœ€å¤š 50 å¼ æ”¶æ®/æœˆ
    - åŸºç¡€æŠ¥è¡¨
    
  Pro Tier ($9/æœˆ):
    - æ— é™æ”¶æ®
    - é«˜çº§æŠ¥è¡¨
    - å¯¼å‡ºåŠŸèƒ½
    - ä¼˜å…ˆæ”¯æŒ
    
  Business Tier ($29/æœˆ):
    - Pro åŠŸèƒ½
    - å›¢é˜Ÿåä½œ
    - API è®¿é—®
    - ç™½æ ‡å®šåˆ¶

ç¬¬ä¸€å¹´ç›®æ ‡:
  Month 3: 50 å…è´¹ç”¨æˆ·ï¼Œ5 ä»˜è´¹ç”¨æˆ· â†’ $45 MRR
  Month 6: 200 å…è´¹ç”¨æˆ·ï¼Œ30 ä»˜è´¹ç”¨æˆ· â†’ $270 MRR
  Month 12: 1,000 å…è´¹ç”¨æˆ·ï¼Œ150 ä»˜è´¹ç”¨æˆ· â†’ $1,350 MRR
  
å¹´æ”¶å…¥: ~$16,200
ROI: ç›ˆäºå¹³è¡¡ + å¯æŒç»­å¢é•¿
```

---

## é™„å½•

### ç¯å¢ƒå˜é‡é…ç½®

```bash
# .env.local
# Supabase
NEXT_PUBLIC_SUPABASE_URL=your-supabase-url
NEXT_PUBLIC_SUPABASE_ANON_KEY=your-anon-key
SUPABASE_SERVICE_ROLE_KEY=your-service-role-key

# Gemini API
GEMINI_API_KEY=your-gemini-api-key

# Cloudflare R2
R2_ENDPOINT=https://your-account-id.r2.cloudflarestorage.com
R2_ACCESS_KEY_ID=your-access-key
R2_SECRET_ACCESS_KEY=your-secret-key
R2_BUCKET_NAME=ledgersnap-receipts
R2_PUBLIC_URL=https://your-r2-public-url

# Next.js
NEXT_PUBLIC_APP_URL=https://dev.ledgersnap.app
```

### æœ‰ç”¨çš„åº“å’Œå·¥å…·

```json
{
  "dependencies": {
    "@google/generative-ai": "^0.1.3",
    "@supabase/supabase-js": "^2.38.0",
    "@aws-sdk/client-s3": "^3.450.0",
    "recharts": "^2.10.0",
    "date-fns": "^2.30.0",
    "zod": "^3.22.4"
  },
  "devDependencies": {
    "@types/node": "^20.0.0",
    "typescript": "^5.3.0"
  }
}
```

---

**ğŸ‰ LedgerSnap MVP è§„æ ¼æ–‡æ¡£å®Œæˆï¼**

ä¸‹ä¸€æ­¥è¡ŒåŠ¨:
1. å®¡æ ¸æŠ€æœ¯æ–¹æ¡ˆ
2. è¿è¡Œæ•°æ®åº“è¿ç§»
3. å¼€å§‹ Week 1 å¼€å‘
4. å®šæœŸåŒæ­¥è¿›åº¦

**é—®é¢˜æˆ–å»ºè®®ï¼Ÿ** éšæ—¶è”ç³» CTO Patrick Jiang è®¨è®ºï¼
