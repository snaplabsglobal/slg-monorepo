# 收据详情页 - 双栏对照侧滑设计

**COO 战略**: 不是简单的弹窗，而是高效的对账工作台

**核心**: 左图右表，一键确认，快速处理

---

## 🎯 设计原则

### COO 的关键洞察
```
问题:
如果详情页做得不好，用户在照片和表单之间来回切换
→ 极大降低效率

解决:
左图右表，双栏对照
→ 一眼看清收据，一键确认数据
→ 处理 50 张收据的速度提升 3 倍以上
```

---

## 📐 布局设计：Slide-over 侧滑面板

### 整体结构
```
┌────────────────────────────────────────────────────────────┐
│  Transactions List (主页面)                                │
│  ┌──────────────────────────────────────────┐              │
│  │ ▢ Home Depot    $50.40    2026-01-28    │              │
│  │ ▢ Shell Gas     $67.20    2026-01-27    │              │
│  │ ▣ Cactus Club   $89.60    2026-01-26    │◄─ 点击这行   │
│  └──────────────────────────────────────────┘              │
│                                                             │
└─────────────────────────────────────────────────────────┬──┤
                                                          │  │
                    侧滑面板从右侧滑出 ────────────────────┤  │
                                                          ▼  │
        ┌──────────────────────────────────────────────────┐│
        │ 收据详情 - Cactus Club                      [✕]  ││
        ├──────────────────────┬───────────────────────────┤│
        │                      │                           ││
        │   收据原图 (60%)      │    AI 识别数据 (40%)      ││
        │                      │                           ││
        │  ┌─────────────────┐ │  Vendor: Cactus Club     ││
        │  │                 │ │  Date: 2026-01-26        ││
        │  │   [收据图片]     │ │                          ││
        │  │                 │ │  Subtotal:    $78.35     ││
        │  │   可缩放/旋转    │ │  GST (5%):    $ 3.92     ││
        │  │                 │ │  PST (7%):    $ 5.48     ││
        │  └─────────────────┘ │  ────────────────────    ││
        │                      │  Total:       $89.60     ││
        │  [旋转] [放大] [缩小] │                          ││
        │                      │  Project: Kitchen Reno   ││
        │                      │  Category: Meals (50%)   ││
        │                      │  GIFI: 8523              ││
        │                      │                          ││
        │                      │  AI Confidence: 94%      ││
        │                      │                          ││
        │                      │  ┌────────────────────┐  ││
        │                      │  │ ✓ 确认并存入队列   │  ││
        │                      │  │   Review Queue     │  ││
        │                      │  └────────────────────┘  ││
        └──────────────────────┴───────────────────────────┘│
                                                            │
        60% / 40% 分栏                                       │
        用户不需要跳转页面 ────────────────────────────────────┘
```

---

## 🎯 COO 战略实现验证

### 1. ✅ 双栏对照
```
左侧 (60%): 收据原图
- 可缩放 (50%-200%)
- 可旋转 (0°, 90°, 180°, 270°)
- 可拖拽移动
- 光线不好/褶皱也能看清

右侧 (40%): 结构化数据
- 供应商
- 日期
- 金额三部曲（Subtotal + GST + PST + Total）
- 项目
- 分类/GIFI
- AI 置信度
```

### 2. ✅ 加拿大特色护城河
```
🇨🇦 加拿大税务明细

小计: $78.35

GST (5%) [可抵扣]     $3.92
Input Tax Credit (ITC)

PST (7%) [不可抵扣]   $5.48
BC Provincial Tax

─────────────────────────
总计: $89.60
```

### 3. ✅ 一键确认
```
巨大的绿色按钮:
✓ 确认并存入 Review Queue

点击后:
- 状态: Pending → Ready
- 自动关闭面板
- 自动打开下一条
- 处理 50 张收据速度提升 3 倍
```

### 4. ✅ Slide-over 侧滑
```
不是新页面:
- 从右侧滑出
- 不需要跳转
- 不需要重新加载
- 确认后立即看下一条

效率提升:
50 张收据 × 3 秒跳转 = 150 秒浪费
Slide-over: 0 秒跳转 ✓
```

---

## 📋 实施清单

### Day 1: 核心组件
```
□ TransactionDetailSlideOver.tsx（容器）
□ ReceiptImagePanel.tsx（左侧图片）
□ TransactionDataForm.tsx（右侧表单）
□ 图片缩放/旋转/拖拽功能
```

### Day 2: 加拿大特色
```
□ 金额三部曲设计
□ GST/PST 分离显示
□ GIFI 代码展示
□ 税务明细卡片
```

### Day 3: 交互优化
```
□ 一键确认功能
□ 自动跳转下一条
□ 编辑模式
□ 保存修改
□ ESC 键关闭
```

### Day 4: 集成测试
```
□ 列表点击打开
□ 确认后更新状态
□ 自动跳转下一条
□ 50 张收据速度测试
```

---

## 🚀 效率对比

### 传统方式（新页面）
```
1. 点击单据 → 跳转新页面 (2秒)
2. 查看详情 → 确认
3. 返回列表 → 再次加载 (2秒)
4. 找到下一条 → 点击 (1秒)

处理 1 条: ~5 秒
处理 50 条: ~250 秒 (4 分钟)
```

### Slide-over 方式（推荐）
```
1. 点击单据 → 侧滑打开 (0.3秒)
2. 查看详情 → 确认
3. 自动跳转下一条 (0.3秒)

处理 1 条: ~1.6 秒
处理 50 条: ~80 秒 (1.3 分钟)

效率提升: 250秒 → 80秒 = 3.1 倍 ✓
```

---

**CTO 总结**: 

✅ **双栏对照**: 左图右表，一眼看清

✅ **加拿大特色**: GST/PST 分离 + GIFI 代码

✅ **一键确认**: 巨大绿色按钮，Pending → Ready

✅ **Slide-over**: 不跳转，自动下一条，效率提升 3 倍

🚀 **立即实施**: 4 天完成，P0 级优先！

完整代码实现请查看项目仓库的 components/transactions/ 目录。
