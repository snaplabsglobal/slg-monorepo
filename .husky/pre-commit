#!/bin/sh
# éƒ¨ç½²å“¨å…µ Layer 1: æäº¤å‰è‡ªåŠ¨åŒæ­¥ lockfile + ç±»åž‹æ£€æŸ¥

echo "ðŸ” Pre-commit checks..."

# è‹¥ package.json æœ‰å˜æ›´ï¼ŒåŒæ­¥ lockfile é¿å… Vercel ERR_PNPM_OUTDATED_LOCKFILE
if git diff --cached --name-only | grep -q "package.json"; then
  echo "ðŸ“¦ Syncing lockfile..."
  pnpm install --lockfile-only
  git add pnpm-lock.yaml 2>/dev/null || true
fi

# TypeScript ç±»åž‹æ£€æŸ¥ï¼ˆmonorepo ä½¿ç”¨ turbo type-checkï¼‰
pnpm type-check || exit 1

echo "âœ… Checks passed!"
